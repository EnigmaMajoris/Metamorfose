---
title: "Toca Raul"
subtitle: "Uma an√°lise de dados sobre o Pai do Rock Brasileiro"
author: 
  - "Majory Melo"
date: "2023-07-22"
categories: 
# exemplo de categorias:
  - "R"
  - "Ci√™ncia de dados"
  - "An√°lise explorat√≥ria"
  - "An√°lise de texto"
  - "Visualiza√ß√£o de dados"
  - "Artigo"
lang: pt
format: html
bibliography: referencias.bib
code-fold: true
code-summary: "Mostrar C√≥digo"
editor: visual
toc: true 
toc-depth: 5 
toc-location: right 
number-sections: true
number-depth: 5 
draft: false
knitr:
    opts_chunk: 
      message: false
      warning: false
theme: 
  light: [flatly, ajustes.css] #modo diurno
  dark: [darkly, ajustes.css] #modo noturno
---

[![Raul Seixas (Imagem: Reprodu√ß√£o/Letras)](imagem/mono.jpeg)](https://www.letras.mus.br/blog/melhores-musicas-raul-seixas/)

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Por qu√™? Pra qu√™? </b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i> "Ser√° que um dia poderei saber / Por que, pra que, pra que, porqu√™? / Porque, pra qu√™?"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/4w2fsMVZ2usncqrDL5F57r?si=36652ba7c8af42db' style='text-decoration: none;'>Raulzito e Os Panteras, 1968</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Conhecido por sua genialidade, excentricidade, poesia, m√∫sica e inova√ß√£o, Raul tinha o sonho de se tornar escritor ou cantor, mas foi muito mais; unindo essas duas formas de express√£o art√≠stica se tornou a figura mais importante na hist√≥ria do rock nacional, um indiv√≠duo questionador, m√≠stico e ir√¥nico, sempre buscando compreender o mundo al√©m do material.

Durante um per√≠odo de intensa repress√£o pol√≠tica, Raul criou, comp√¥s e se contrap√¥s. E em resposta, recebeu censuras, pris√£o e ex√≠lio.

Quantas vis√µes e curiosidades permeiam o Universo Raul Seixas?

Nesta humilde homenagem, vamos reunir um pouco delas por meio da an√°lise e visualiza√ß√£o de dados contidos em sua obra.
:::

::: callout-warning
Este artigo cont√©m altas doses de refer√™ncias musicais.

Quer conhecer mais sobre a obra de Raulzito? Ent√£o, d√° um play e...[Toca Rauul!üé∏](https://open.spotify.com/playlist/3eb5MsPwTdQBZDJZTD0H14?si=af590ddb486145e7)
:::

```{=html}
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/3eb5MsPwTdQBZDJZTD0H14?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
# Eu sou o in√≠cio

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Eu nasci h√° dez mil anos atr√°s</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i> "Eu li os simbolos sagrados de Umbanda / Eu fui crian√ßa pra poder dan√ßar ciranda / E, quando todos praguejavam contra o frio / Eu fiz a cama na varanda"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/7nJuEpX0qlpKXxUK0ioIMj?si=53370ff5de514a82' style='text-decoration: none;'>H√° Dez Mil Anos Atr√°s, 1976</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Raul Santos Seixas, nasceu em Salvador/BA no dia 28 de junho de 1945. Filho de um engenheiro e de uma dona de casa. Tem um irm√£o que √© tr√™s anos mais novo.

Odiava a escola mas adorava ler, queria ser escritor assim como Jorge Amado, seu conterr√¢neo.

Na adolesc√™ncia, se aproximou da m√∫sica, mais precisamente do g√™nero rock e chegou a fundar at√© um clube, o <i>Elvis Rock Club</i>. Nesse per√≠odo, conhece os membros de sua futura banda, <i>Rel√¢mpagos do Rock</i>, que mais tarde trocariam o nome para <i>The Panters</i> at√© chegar em <b><i>Raulzito e Os Panteras</b></i>

Com a banda formada e o nome definido, recebem o convite para mudarem para o Rio de Janeiro com a proposta de gravarem um √°lbum e dar in√≠cio, oficialmente, √† carreira musical.
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Ouro de tolo</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Eu devia estar alegre e satisfeito / ... / Depois de ter passado fome por dois anos / Aqui na Cidade Maravilhosa"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/1j5i8qd1PkSQAGM5zyonJC?si=3a87e7d462b94a0b' style='text-decoration: none;'>Krig-ha, Bandolo!, 1973</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Mas como nem tudo que reluz √© ouro, a vida na Cidade Maravilhosa n√£o foi f√°cil, o √°lbum veio, mas a dificuldade em torn√°-lo popular culminou no t√©rmino da banda e no regresso dos integrantes √† Bahia.
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Tente outra vez</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Veja / N√£o diga que a can√ß√£o est√° perdida / Tenha f√© em Deus, tenha f√© na vida / Tente outra vez"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/6YXOsfhu4fDWcHV14tcF3x?si=4581d34c479a4101' style='text-decoration: none;'>Novo Aeon, 1975</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
De volta a Salvador, Raul se tranca no quarto e mergulha de vez nos livros de filosofia e misticismo. At√© que o diretor da CBS Discos, um conhecido dos tempos da banda, faz uma proposta para que ele assumir o cargo de produtor musical da gravadora e, assim, Raul retorna mais uma vez ao Rio de Janeiro.

Durante os tempos de CBS, grava o √°lbum [Sociedade Da Gr√£-Ordem Kavernista Apresenta Sess√£o das 10](https://open.spotify.com/intl-pt/album/1VLAdz5Y3GYXyIN7hxUDtu?si=RpIZXsB0SlypO0g_LNHvMw).

No ano seguinte, convencido pelo amigo e m√∫sico [S√©rgio Sampaio](https://pt.wikipedia.org/wiki/S%C3%A9rgio_Sampaio), participa do [Festival Internacional da Can√ß√£o](https://www.festivalnacionaldacancao.com.br/) de 1972, onde apresenta as m√∫sicas [Let Me Sing, Let Me sing](https://open.spotify.com/intl-pt/track/1l3jakiruEgFWP7GYz19VA?si=23ff3a03b8e049c0), interpretada por ele e, [Eu Sou Eu, Nicuri √â o Diabo](https://open.spotify.com/intl-pt/track/3vXp4x1rotDnNL4PRMNJv2?si=338074842b0d43b8), interpretada por <i>Lena Rios & Os Lobos</i>.

Ambas as m√∫sicas chegam ao final da competi√ß√£o, e Raul assina contrato com a gravadora <i>Philips Records</i>
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Super her√≥is</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Hoje √© segunda-feira e decretamos feriado / Chamei Dom Paulo Coelho e sa√≠mos lado a lado"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/3up2ttgI4CowrkMO6MJ8XO?si=56cd1b93cde84379' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Ao ler um artigo sobre ufologia publicado na revista <b><i>Pomba</b></i>, Raul fica empolgado e busca conhecer o autor. Assim, nasce a amizade e a parceria com [Paulo Coelho](https://pt.wikipedia.org/wiki/Paulo_Coelho), que dura tempo suficiente para o lan√ßamento de 4 √°lbuns, [Krig-Ha, Bandolo](https://open.spotify.com/intl-pt/album/2xRddGxRH0KdDWLNE5b0iu?si=GpshP3iyR7u6LT9dpq7Rsw), 1973; [Gita](https://open.spotify.com/intl-pt/album/4EGy60w4omhOI8AJRxCSzI?si=0mAmDoZ5T_qmljSU_w03ow), 1974; [Novo Aeon](https://open.spotify.com/intl-pt/album/3hgOfaE0yiMg511d0Y1JfJ?si=n7QYsJz9R2eecCTgfjL2lA), 1975 e [H√° 10 Mil Anos Atr√°s](https://open.spotify.com/intl-pt/album/4olOj6yjNB49NOej2lZynI?si=2k12tlEwRcaFGoMQpAyT9Q), 1976, e grandes sucessos como [Metamorfose Ambulante](https://open.spotify.com/intl-pt/track/2Yk0HvfTaijA47aM0Fj88u?si=1ec465aaddef4697), [Sociedade Alternativa](https://open.spotify.com/intl-pt/track/0c1luA21JOCnndDa6Lx86G?si=43d59b5d536b4e83), [A ma√ß√£](https://open.spotify.com/intl-pt/track/5IHwXodK9GpYmX8AGPMvdx?si=e2d342db74194ab5), [Eu Tamb√©m Vou Reclamar](https://open.spotify.com/intl-pt/track/24THMB0HIJ7VwhT2rCpLpT?si=b8abc0693fc94b77) e tantos outros <i>hits</i> que inspiraram os subt√≠tulos deste artigo.

O estilo de vida e as can√ß√µes inspiradas na <i>Lei da Thelema</i> proposta pelo ingl√™s [Aleister Crowley](https://pt.wikipedia.org/wiki/Aleister_Crowley) fez com que a dupla fosse persseguida pelo D.O.P.S - Departamento de Ordem Pol√≠tica e Social, resultando em m√∫sicas censuradas, pris√£o e ex√≠lio por um ano, nos Estados Unidos.

Durante o ex√≠lio, o √°lbum <i>Gita</i> √© lan√ßado e se torna um grande sucesso, permitindo o retorno dos artistas ao pa√≠s.
:::

# O fim

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Movido √† √°lcool</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Por que que o posto anda comprando tanta cana / Se o estoque do boteco j√° est√° pra terminar? / Derramar cacha√ßa em autom√≥vel / √â a coisa mais sem gra√ßa / De que eu j√° ouvi falar / Por que cortar assim nossa alegria?</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/6IElCxBLHJ1h1tEfkUtyaw?si=137c9aa16cb1430d' style='text-decoration: none;'>Porquem os Sinos Dobram, 1979</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
J√° no Brasil, a amizade entre Raul e Paulo diminui e a dupla se separa em 1976.

Em 1977, em parceria com [Cl√°udio Roberto](https://pt.wikipedia.org/wiki/Cl%C3%A1udio_Roberto), ele lan√ßa o √°lbum [O Dia Que A Terra Parou](https://open.spotify.com/intl-pt/album/1NVVfPAGKsOYcWnkDe1lPV?si=dHpDUlP6SESzNdt5bKQneg) que cont√©m seu sucesso mais conhecido, [Maluco Beleza](https://open.spotify.com/intl-pt/track/1qD6F4egXG4T8niy2nBi8U?si=b36a508aa2e5403d).
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>N√£o quero mais andar na contram√£o</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Titia que morava na Argentina voltou / Riu de mim porque eu n√£o entendi / Me trouxe uma caixa de perfume √™ √™ / Daquele que n√£o tem mais por aqui / Eu disse n√£o n√£o n√£o n√£o / N√£o brinco mais carnaval / Cansei de desmaiar no sal√£o / Muito obrigado eu j√° andei perfumado / N√£o quero mais andar na contra-m√£o"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/5x2izy5np3xNzN9Gomq8Nj?si=b686f7b29e664f95' style='text-decoration: none;'>Porquem os Sinos Dobram, 1979</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Da√≠ pra frente, foi s√≥ pra tr√°s.

Os problemas com √°lcool afetam drasticamente a sa√∫de e a qualidade musical de Raul.

Diante de dificuldades financeiras e sa√∫de cada vez mais debilitada, ele reconhece que tem um problema e decide se tratar.
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Anos 80</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Hey! Anos 80! / Charrete que perdeu o condutor / Hey anos 80! / Melancolia e promessas de amor"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/2rRYtP29evLeX2HHt1ozWE?si=78acc4d66e3944c5' style='text-decoration: none;'>Abre-te, S√©samo, 1980</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Os anos 80 para o nosso [Canceriano Sem Lar](https://open.spotify.com/intl-pt/track/6ca96JFHgllqYZJoaDO6EH?si=5d78d01368564cdc) foi marcado por entradas e sa√≠das de cl√≠nicas de reabilita√ß√£o; trocas de gravadoras; shows e discos com poucas vendas e, por idas e vindas de relacionamentos.

Oficialmente ele teve cinco relacionamentos entre casamentos e uni√£o est√°vel, destes relacionamentos ele teve tr√™s filhas, uma com cada esposa diferente.

Foi durante uma participa√ß√£o num disco da banda [Camisa de V√™nus](http://www.camisadevenusoficial.com.br/) que nasce a parceria com o tamb√©m baiano [Marcelo Nova](https://pt.wikipedia.org/wiki/Marcelo_Nova)
:::

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Quando eu morri</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Quando eu morri suando frio / Vi Jimi Hendrix tocando nuvens distorcidas"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/6e1HcY9jd7VXz3XSR4jbcS?si=198030625f8341d1' style='text-decoration: none;'>A Panela do Diabo, 1989</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Desta parceria saiu uma turn√™ pelo Brasil com 50 shows e um alb√∫m, [A Panela Do Diabo](https://open.spotify.com/intl-pt/album/5lJyJ0p9mdjHoQXfTMwxxk?si=3L-24y3IRrGIqA_p7Htgeg), que foi lan√ßado alguns dias antes de Raul ser encontrado sem vida em seu apartamento em S√£o Paulo.

Raul Santos Seixas, morreu em decorr√™ncia de pancreatite aguda, em 21 de agosto de 1989.
:::

# E o meio

A principal motiva√ß√£o desse trabalho √© refor√ßar o conhecimento e colocar em pr√°tica os conceitos abordados nas disciplinas do cursos de MBA em Data Science e Analytics da USP/ESALQ.

De uma forma despojada, vamos aplicar as etapas da ci√™ncia de dados, representada na figura abaixo, sobre a discografia do Raul Seixas.

[![Arte por Allison Horst - \@allison_horst](imagem/EtapasAnaliseDados.png){fig-align="center"}](https://github.com/allisonhorst/stats-illustrations/blob/main/openscapes/environmental-data-science-r4ds-general.png)

O objetivo da an√°lise de dados √© extrair *insights* e tomar decis√µes com base nos dados coletados, com o uso do processo de inspecionar, limpar, transformar e modelar, envolvendo as seguintes etapas:

1.  ***Defini√ß√£o do problema:*** Consiste em identificar o objetivo da an√°lise e as perguntas a serem respondidas.
2.  ***Coleta de dados:*** Obter os dados necess√°rios de fontes relevantes e confi√°veis.
3.  ***Limpeza e pr√©-processamento dos dados:*** Examinar e tratar os dados em busca de inconsist√™ncias, dados ausentes, ou erros. Inclui etapas como remo√ß√£o de valores ausentes, tratamento de outliers e padroniza√ß√£o dos dados.
4. ***An√°lise explorat√≥ria:*** Identificar padr√µes, tend√™ncias e relacionamentos. Isso pode incluir a cria√ß√£o de visualiza√ß√µes, c√°lculos estat√≠sticos e resumos descritivos.
5.  ***Modelagem e an√°lise avan√ßada:*** Aplicar t√©cnicas de estat√≠sticas, algoritmos de aprendizado de m√°quina ou outras abordagens para extrair insights dos dados e responder √†s perguntas de an√°lise definidas anteriormente.
6.  ***Interpreta√ß√£o e comunica√ß√£o dos resultados:*** Interpretar os resultados obtidos da an√°lise, tirar conclus√µes relevantes e comunicar as percep√ß√µes de maneira clara e acess√≠vel, por meio de relat√≥rios, visualiza√ß√µes ou apresenta√ß√µes.

## Prel√∫dio

```{=html}
<div style='text-align: left;'>
        <font size='2'>(<a href='https://open.spotify.com/intl-pt/track/2uDnC0z7d1inMFx5E0XiPN?si=496556434f084c55' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
```
####### 

Antes de dar in√≠cio a nossa an√°lise dos dados √© preciso:

1.  **Carregar pacotes**

```{r}

library(tidyverse)
library(spotifyr)
library(highcharter)
library(stringr)
library(ggridges)
library(ggthemes)
library(DT)
library(httr)
library(rvest)
library(stopwords)
library(wordcloud2)
library(tm)
library(tidytext)
library(textdata)
library(fmsb)
library(radarchart)
library(scales) 
library(widyr) 
library(ggraph) 
library(igraph) 

```

::: {style="text-align: justify;"}
Mas para que servem esses pacotes?

O pacote `tidyverse` √© considerado o pacote base do R, ao carregarmos ele estamos carregando tamb√©m outros pacotes como:

-   `{readr}` importa bases de dados para o R;

-   `{tidyr}` e `{dplyr}` manipula dados;

-   `{stringr}` trabalha com textos;

-   `{ggplot2}` trabalha com gr√°ficos.

O pacote `ggridges` serve de extens√£o ao pacote `ggplot2` para compararmos a distribui√ß√£o de uma vari√°vel X em v√°rios n√≠veis de uma vari√°vel Y. J√° o pacote `highcharter` cria gr√°ficos interativos, enquanto que o pacote `DT` cria tabelas interativas, permitindo pagina√ß√£o e pesquisar as informa√ß√µes nelas contidas. As bibliotecas `httr` e `rvest`s√£o usadas principalmente para interagir com APIs da web e realizar opera√ß√µes de web scraping, respectivamente.

Os pacotes `tm`, `tidytext` e `textdata` s√£o usados para realizar a minera√ß√£o, manipula√ß√£o e an√°lise de textos.

A biblioteca `stopwords` √© usada para remover da an√°lise palavras que s√£o irrelevante na an√°lise de texto, como por exemplo os artigos e pronomes. Enquanto que a biblioteca `wordcloud2` permite criar nuvens de palavras a partir de um conjunto de texto. Uma nuvem de palavras √© uma representa√ß√£o visual das palavras mais frequentes em um corpo de texto, onde o tamanho de cada palavra √© proporcional √† sua frequ√™ncia no texto.

Faremos uso dos pacotes `fmsb` e `radarchart` para criarmos um gr√°fico de teia que ser√° utilizado para demonstrar a an√°lise de sentimento das letras de m√∫sica. 

Com a biblioteca `scales` ser√° poss√≠vel ajustar as caracter√≠sticas e esclas dos gr√°ficos e com `widyr` pode-se calcular correla√ß√µes entre vari√°veis de texto, permitindo analisar relacionamentos entre v√°rias vari√°veis de texto.

Para visualizar as correla√ß√µes entre as m√∫sicas faremos uso dos pacotes `igraph`, que cria e permite a manipula√ß√£o de um gr√°fico de rede e o pacote `ggraph` que ter√° o papel de "plotar" esse gr√°fico.

E por √∫ltimo, mas n√£o menos importante, temos o pacote `spotifyr` que permite obter e realizar alguns entendimentos sobre os dados mantidos pelo [*Spotify*](https://open.spotify.com/), com algumas das fun√ß√µes abordadas ao longo deste trabalho.
:::

2.  **Configurar as APIs do Spotify e Criar Reposit√≥rio de M√∫sicas**

::: {style="text-align: justify;"}
O primeiro passo √© obter os *IDs* da sua conta do *Spotify*. N√£o tem ideia de como fazer isso? Ent√£o, siga esse tutorial [Acessando a API do Spotify](https://dandaramcsousa.github.io/2020/05/20/tutorial-api-spotify.html).

De posse dos *IDs*, √© preciso executar o c√≥digo abaixo para termos acessos aos dados sobre as m√∫sicas do nosso [Cowboy Fora da Lei](https://open.spotify.com/intl-pt/track/2kVm4qAAXR7qUfHdiKg0qI?si=4d7ef72861f843c0), usando a fun√ß√£o `get_artist_audio_features`.

Como este artigo foi elaborado para que qualquer pessoa possa reproduzir com exatid√£o todos os resultados demonstrados, optei por salvar a base de dados para evitar que ocorra v√°rias chamadas √†s APIs; por esta raz√£o, o c√≥digo est√° inibido.
:::

``` r

Sys.setenv(SPOTIFY_CLIENT_ID = "Seu Client ID")
Sys.setenv(SPOTIFY_CLIENT_SECRET = "Seu Client Secret")

raul1 <- get_artist_audio_features("raul seixas")
write_csv(raul1, "dados/raul1.csv")
raul2 <- get_artist_audio_features("raulzito e os panteras")
write_csv(raul2, "dados/raul2.csv")
raul3 <- get_artist_audio_features("sociedade da gra-ordem kavernista")

raul <- rbind(raul1, raul2, raul3)
write_csv(raul, "dados/raul.csv")
```

3.  **Criar Reposit√≥rio de Letras de M√∫sica**

As letras ser√£o obtidas na p√°gina dedicada ao Raul mantida pelo site [Letras](https://www.letras.mus.br/raul-seixas/)

[![P√°gina do artista (Imagem: Reprodu√ß√£o/Letras)](imagem/SiteLetras.png){fig-align="center"}](https://www.letras.mus.br/raul-seixas/)

::: {style="text-align: justify;"}
O c√≥digo abaixo demonstra a "raspagem" que ser√° feita na p√°gina, utilizando as bibliotecas `httr` e `rvest`. Em outras palavras, o algoritmo encontrar√° o link para cada m√∫sica na p√°gina de Raul Seixas e a letra correspondente a cada can√ß√£o. Em seguida, ser√° criada uma tabela com as colunas "<b><i>nome</b></i>" (nome da m√∫sica) e "<b><i>verso</b></i>", onde cada linha da tabela corresponde a um verso de cada m√∫sica coletada.

No final, √© gerado um arquivo CSV que ser√° o nosso reposit√≥rio de dados.

Assim, como ocorreu anteriormente, para evitar a realiza√ß√£o de v√°rias chamadas a *url*, o c√≥digo tamb√©m foi desabilitado nesta etapa.
:::

``` r

#A url utilizada ser√° a da p√°gina da Raul no site:
url <- "https://www.letras.mus.br/raul-seixas/"

# Realizar a requisi√ß√£o HTTP para obter o HTML da p√°gina
response <- read_html(url)

# Encontra todos os links das m√∫sicas
links <- response |>
  html_nodes('a.song-name')

# Criar um data frame vazio com as colunas 'nome' e 'verso'
letras <- data.frame(nome = character(), verso = character(), stringsAsFactors = FALSE)

for (link in links) {
  song_url <- link |> html_attr('href')
  song_url2 <- paste0("https://www.letras.mus.br", song_url)
  song_title <- link |> html_text() |> str_trim()
  song_response <- read_html(song_url2)
  lyrics_div <- song_response |>
    html_nodes('div.cnt-letra')
  
  if (length(lyrics_div) > 0) {
    # Extrair cada verso da letra e adicionar como uma nova linha no data frame
    verses <- lyrics_div |>
      html_text() |>
      str_split('\n') |>
      unlist() |>
      str_trim() |>
      na.omit()
      
    data <- data.frame(nome = rep(song_title, length(verses)), verso = verses, stringsAsFactors = FALSE)
    letras <- bind_rows(letras, data)
  } else {
    cat(sprintf("N√£o foi poss√≠vel encontrar a letra da m√∫sica '%s'.\n", song_title))
  }
}

# Salva o data frame em um arquivo CSV
write.csv(letras, file = 'dados/letras.csv', row.names = FALSE)
```

####### 

## T√° na hora

```{=html}
<div style='text-align: left;'>
        <font size='2'>(<a href='https://open.spotify.com/intl-pt/track/6fjstmexVLgjqYgFpzc0gL?si=aa533bc790e842df' style='text-decoration: none;'>Mata Virgem, 1978</a>)</font>
      </div>
```
####### 

::: {style="text-align: justify;"}
Agora, que j√° realizamos a importa√ß√£o dos dados, vamos iniciar a an√°lise da obra do nosso artista **Maluco Beleza**. Para isso, vamos divid√≠-la em duas partes:

1.  **An√°lise das M√∫sicas**

2.  **An√°lise das Letras**
:::

### An√°lise das M√∫sicas

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Cantar</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i> "Eu j√° falei sobre disco voador / E da metamorfose que eu sou / Eu j√° falei s√≥ por falar / Agora eu vou cantar por cantar /... / Cantar tudo o que vier na cabe√ßa / Eu vou cantar at√© que o dia amanhe√ßa"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/4vDZfAcc3O7sCA09YZ0tCE?si=7afa6bdb25ab4c64' style='text-decoration: none;'>Uah-Bap-Lu-Bap-Lah-B√©in-Bum!, 1987</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

#### An√°lise e tratamento dos dados

-   Analisando o arquivo de m√∫sicas obtidas do *Spotify* `raul`

```{r}

raul <- read_csv("dados/raul.csv")
glimpse(raul)

```

::: {style="text-align: justify;"}
Aqui j√° conseguimos ver que o *dataframe* tem 39 colunas e 529 linhas, que correspondem a cada faixa de m√∫sica. H√° uma coluna com o formato errado, a `album_release_date` (Data de Lan√ßamento do √Ålbum), que ora apresenta o formato **ano-m√™s-dia**, ora apenas o **ano**. Como n√£o faremos uso desse atributo, n√£o iremos ajust√°-lo.

Para descobrir quantas faixas cada √°lbum tem, vou utilizar o **"GSA"** (as fun√ß√µes `group_by`, `summarise` e `arrange` do pacote `dplyr`):
:::

```{r}

raul |>
  group_by(album_name, album_release_year) |>
  summarise(faixas = n()) |>
  arrange(desc(faixas)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c("compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Quantidade de faixas por √°lbum"
  )

```

####### 

::: {style="text-align: justify;"}
Ao longo dos 26 anos de carreira, Raul Seixas lan√ßou 17 √°lbuns.

Nesta extra√ß√£o, observa-se que h√° 35 √°lbuns relacionados, logo, conclui-se que nela al√©m dos √°lbuns de estudio, constam tamb√©m √°lbuns de colet√¢nias e audio-livros, como √© o caso do audio-livro *"Ba√∫ do Raul"*, que segundo a amostragem √© tido o √°lbum com maior n√∫mero de faixas, 68 faixas.

Para as an√°lises deste trabalho, iremos considerar apenas os √°lbuns da discografia em est√∫dio, e dos 17 √°lbuns, iremos considerar apenas 16, pois o √°lbum [*Os 24 Maiores Sucessos da Era do Rock*](https://pt.wikipedia.org/wiki/Os_24_Maiores_Sucessos_da_Era_do_Rock), lan√ßado em 1973 s√≥ foi creditado ao Raul Seixas em 1975, por sua participa√ß√£o na produ√ß√£o e tamb√©m como cantor na maioria das faixas.

Feita as explica√ß√µes, vamos criar um novo *objeto* `album_raul`, ordenando-o pelo o ano de lan√ßamento dos discos.
:::

```{r}

album_raul <- raul |>
  filter(album_name %in% c("Raulzito E Os Panteras", "Sess√£o das 10", "\"Krig-Ha, Bandolo\"", "Gita", "Novo Aeon", "H√° 10 Mil Anos Atr√°s", "Raul Rock Seixas", "O Dia Em Que A Terra Parou", "Mata Virgem", "Por Quem os Sinos Dobram", "Abre-Te S√©samo", "Raul Seixas", "Metr√¥ Linha 743", "Uah-Bap-Lu-Bap-Lah-Bein-Bum", "A Pedra Do G√™nesis", "A panela do Diabo")) |>
  arrange(album_release_year)

```

####### 

::: {style="text-align: justify;"}
Considerando o novo *objeto* voltemos a pergunta: Quantas faixas cada √°lbum tem?
:::

```{r}

album_raul |>
  group_by(album_name, album_release_year) |>
  summarise(faixas = n()) |>
  arrange(desc(faixas)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c(
        "compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Quantidade de faixas por √°lbum"
  )

```

####### 

::: {style="text-align: justify;"}
Tanto o √°lbum *Gita* quanto o √°lbum *Novo Aeon* possuem 14 faixas, cada, mas ser√° que por serem os √°lbuns com mais faixas, eles s√£o os mais longos? Para responder essa pergunta, usaremos a fun√ß√£o `duration_ms` do pacote `spotifyr`.

Contudo identifiquei que os √°lbuns **A Panela do Diabo** e **O Dia Em Que A Terra Parou** est√£o com a data de lan√ßamento posterior a morte de Raul, 1989. Isso ocorreu porque estes √°buns foram relan√ßados nas datas indicadas na tabela.

Com as fun√ß√µes `mutate()` e `replace()` do pacote `dplyr` vamos ajustar essas datas para as datas do primeiro lan√ßamento,1989 e 1977, respectivamente, conforme declarado na [*Discografia de Raul Seixas*](https://pt.wikipedia.org/wiki/Discografia_de_Raul_Seixas) na *Wikipedia* e, vamos aproveitar e inserir uma nova coluna, `album`, em nosso banco de dados que demonstre o nome do album, juntamente com a respectiva data de seu lan√ßamento:
:::

```{r}

album_raul <- album_raul |>
  mutate(
    album_release_year = replace(album_release_year, album_name == "A panela do Diabo", 1989),
    album_release_year = replace(album_release_year, album_name == "O Dia Em Que A Terra Parou", 1977),
    album = paste(album_name, "-", album_release_year)
  )

album_raul |>
  group_by(album_name, album_release_year, album) |>
  summarise(duracao = sum(duration_ms)) |>
  arrange(desc(duracao)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      theme = "darkly",
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE
    ),
    caption = "Dura√ß√£o de cada √°lbum do Raul Seixas, em milissegundos"
  )

```

####### 

::: {style="text-align: justify;"}
Verifica-se que a *A Panela do Diabo* √© o √°lbum mais longo da discografia de Raul, seguido do √°lbum *Gita*.

Ainda analizando o nosso banco de dados `album_raul`, outra informa√ß√£o que poderemos extrair s√£o os acordes.

Abaixo est√£o os tr√™s acordes mais utilizados nas m√∫sicas de Raul.
:::

```{r}

album_raul |>
  count(key_mode, sort = TRUE) |>
  head(3) |>
  datatable(
    caption = "Acordes mais utilizados"
  )

```

####### 

#### Sentimentos

::: {style="text-align: justify;"}
Al√©m de informa√ß√µes objetivas, como: quantidade de faixas, acordes e dura√ß√£o de cada √°lbum, o pacote `spotifyr` permite analisar o sentimento das m√∫sicas.

E uma das melhores forma de fazer isso, na minha opini√£o, √© por meio da `val√™ncia` definida pelo *Spotify* @SpotifyAPI como:

*"Uma medida de 0,0 a 1,0 que descreve a positividade musical transmitida por uma faixa. Faixas com alta val√™ncia soam mais positivas (por exemplo,alegre, euf√≥rica, feliz), enquanto faixas com baixa val√™ncia soam mais negativas (por exemplo, triste, deprimido, zangado)."*

O gr√°fico abaixo demonstra uma vis√£o geral da val√™ncia por √°lbum:
:::

```{r}

album_raul |>
  arrange(album_release_year) |>
  mutate(album = factor(album, levels = rev(unique(
    album_raul$album
  )))) |>
  ggplot(aes(x = valence, y = album, fill = album)) +
  geom_density_ridges(
    from = 0,
    to = 1,
    alpha = 1,
    size = 0.1
  ) +
  labs(
    x = "Escala de val√™ncia",
    y = "",
    title = "Distribui√ß√£o da postividade das m√∫sicas de Raul Seixas por √°lbum",
    subtitle = "Val√™ncia: Faixas com maiores n√≠veis de val√™ncia soam mais positivas",
    caption = "por Majory Melo - @EnigmaMajoris | Fonte: Spotify's Web API"
  ) +
  scale_fill_cyclical(values = c("#9A373F")) +
  theme_ridges() +
  theme(
    plot.title = element_text(
      hjust = 0.5,
      size = 12,
      color = "#000000",
      face = "bold",
      family = "Bitter"
    ),
    plot.title.position = "plot",
    plot.subtitle = element_text(
      face = "italic",
      hjust = 0.5,
      size = 10,
      family = "Bitter"
    ),
    axis.text.y = element_text(size = 10, family = "Raleway"),
    axis.title.x = element_text(
      hjust = 0.5,
      size = 11,
      family = "Raleway"
    ),
    plot.caption = element_text(size = 9, family = "Bitter")
  )


```

####### 

::: {style="text-align: justify;"}
O gr√°fico mostra "uma onda" por √°lbum. Os picos s√£o os valores com mais faixas naquele ponto da escala de val√™ncia.

Analisando o gr√°fico, percebemos que os √°lbuns *Sess√£o das 10*, *Abre-Te S√©samo* e *Raul Seixas*, s√£o os mais positivos.

Agora, para sabermos o √°lbum mais positivo, vamos utilizar a mediana da val√™ncia de cada √°lbum.

Segundo @ManualAnaliseDados, *"a mediana √© uma medida de localiza√ß√£o do centro da distribui√ß√£o de um conjunto de dados ordenados de forma crescente. Seu valor separa a s√©rie em duas partes iguais, de modo que 50% dos elementos s√£o menores ou iguais √† mediana e os outros 50% s√£o maiores ou iguais √† mediana."*

Escolhemos a mediana quando temos dados com valores extremos ou assimetria na distribui√ß√£o, como demontra o gr√°fico anterior, pois ela n√£o √© influenciada por valores extremos, ao contr√°rio, da m√©dia aritm√©tica.
:::

```{r}

album_raul |>
  group_by(album) |>
  summarise_at(vars(valence), list(mediana = ~round(median(., na.rm = TRUE), 3))) |>
  arrange(desc(mediana)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c(
        "compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Mediana da val√™ncia de cada √°lbum da Raul Seixas"
  )
```

####### 

::: {style="text-align: justify;"}
N√£o √© de se surpreender que o √°lbum *Sess√£o das 10* seja o mais positivo, afinal como escreveu o jornalista e m√∫sico @LeonardoNova "*Um disco nonsense, poder√≠amos resumir (...) O √°lbum encerra com um sugestivo som de descarga numa privada. No meio disso tudo, chorinho, bai√£o, seresta, xaxado, calypso, rock, samba e o que mais desse na veneta (...) Nem os tropicalistas ousaram tanta galhofa num √∫nico disco.*"

Para finalizarmos nossa an√°lise sobre a `val√™ncia`, vamos avaliar qual a m√∫sica mais positiva e qual a menos positiva de toda colet√¢nia de Raul.
:::

```{r}

# Mais positiva
album_raul$track_name[which.max(album_raul$valence)]

```

A m√∫sica mais positiva √©, *Aos Trancos e Barrancos*, que pertence ao √°lbum considerado o mais positivo, *Sess√£o das 10*.

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/6B3fM3qv1Xd32WcjP9LfxB?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
####### 

```{r}

# Menos positiva
album_raul$track_name[which.min(album_raul$valence)]

```

Enquanto que *Cantiga de Ninar* do √°lbum *H√° 10 Mil Anos Atr√°s*, √© a menos positiva das 179 m√∫sicas contidas na an√°lise. O que at√© faz sentido, pois se tratando de uma can√ß√£o de ninar o ritmo √© mais lento e o tom mais baixo.

```{=html}
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/0w7YNpDyG5TkOTez8LQs7x?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
####### 

::: {style="text-align: justify;"}
O atributo `speechiness` (*fala*) detecta a presen√ßa de palavras faladas em uma faixa musical enquanto que o `instrumentalness` (*instrumentalidade*) verifica a aus√™ncia de vocais.

De acordo com o Spotify @SpotifyAPI, *"Quanto mais exclusivamente falado for o registro (por exemplo, programa de entrevista, audiolivro, poesia), mais pr√≥ximo de 1.0 ser√° o valor do atributo* ***fala***. *J√° na* ***instrumentalidade***, *sons de* **"Ooh"** *e* **"Aah"** *s√£o tratados como instrumentais nesse contexto. Quanto mais pr√≥ximo o valor de instrumentalidade for de 1.0, maior a probabilidade de a faixa n√£o conter conte√∫do vocal. Valores acima de 0.5 pretendem representar faixas instrumentais, mas a confian√ßa √© maior √† medida que o valor se aproxima de 1.0"*.

Em nossa an√°lise, a m√∫sica *Caminhos* se apresenta com o maior `speechiness`.
:::

```{r}

# Mais falada
album_raul$track_name[which.max(album_raul$speechiness)]

```

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/1GMkxUWAyw07q5cuSbBb9l?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
::: {style="text-align: justify;"}
Confesso que n√£o esperava que ela fosse tida como a mais falada, pois quando li a descri√ß√£o de `speechiness` a primeira m√∫sica que me veio √† mente foi *Canto Para Minha Morte*
:::

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/7xPFeH7wnpLC6Z3opkXYIK?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
::: {style="text-align: justify;"}
Comparando as duas m√∫sicas, percebemos que elas est√£o bem distantes no ranking das m√∫sicas com mais falas. A m√∫sica que considero a mais falada ocupa a posi√ß√£o 98¬™ de um ranking de 179 m√∫sicas e, acredito que a vari√°vel `duration_ms` tenha alguma rela√ß√£o sobre a vari√°vel `speechiness`. *Caminhos* tem em torno de 01m48s enquanto que *Canto Para Minha Morte* possui 03m50, mas que o dobro da primeira colocada. Por√©m, como a documenta√ß√£o n√£o traz muitos detalhes sobre os atributos, fica invi√°vel fazer qualquer afirma√ß√£o.
:::

```{r}

# Criar uma coluna com o Rank de m√∫sicas mais faladas
rank_fala <- album_raul |>
  mutate(posicao = rank(-speechiness))

# Criar tabela com a rela√ß√£o das m√∫sicas selecionadas
rank_fala |>
  arrange(desc(speechiness)) |>
  filter(track_name %in% c("Caminhos", "Canto Para Minha Morte")) |>
  select(track_name, posicao) |>
  datatable(
          extensions = c("FixedColumns", "FixedHeader"),
          options = list(
            scrollX = FALSE,
            paging = TRUE,
            fixedHeader = TRUE,
            class = c("compact", "row-border", "hover", "nowrap")
          ),
          caption = "M√∫sicas com mais falas")

```

####### 

::: {style="text-align: justify;"}
J√° a m√∫sica *Requien para uma flor* possui o valor mais alto para o indicador `instrumentalness`.
:::

```{r}

# Mais instrumental
album_raul$track_name[which.max(album_raul$instrumentalness)]

```

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/2Aau4V56YL4xeIIzN1EmFF?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
::: {style="text-align: justify;"}
Ao ouvirmos a can√ß√£o, d√° para notar que entre um verso e outro, h√° uma tempo razo√°vel de som instrumental. Ent√£o, pra mim, faz sentido ela ser apontada como sendo a m√∫sica com menos conte√∫do vocal.

Dando continuidade, o pr√≥ximo atributo a ser analizado √© `danceability`, que descreve o qu√£o adequada uma faixa √© para dan√ßar, com base em uma combina√ß√£o de elementos musicais incluindo tempo, estabilidade r√≠tmica, for√ßa do beat e regularidade geral. Um valor de 0 √© o menos dan√ßante e 1 √© o mais dan√ßante.

Desse modo, vemos que a faixa que tem o valor m√°ximo de "*danceabilidade*" √© *O Trem das Sete*
:::

```{r}

album_raul$track_name[which.max(album_raul$danceability)]

```

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/6zAxMr8eEf2TKUevXwKykM?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
```{r}

album_raul |>
  arrange(album_release_year) |>
  mutate(album = factor(album, levels = rev(unique(
    album_raul$album
  )))) |>
  ggplot(aes(x = danceability, y = album, fill = album)) +
  geom_density_ridges(
    from = 0,
    to = 1,
    alpha = 1,
    size = 0.1
  ) +
  labs(
    x = "Escala de \"Dan√ßabilidade\"",
    y = "",
    title = "Distribui√ß√£o do n√≠vel dan√ßante das m√∫sicas de Raul Seixas por √°lbum",
    subtitle = "\"Dan√ßabilidade\": Mede as m√∫sicas mais e menos dancantes",
    caption = "por Majory Melo - @EnigmaMajoris | Fonte: Spotify's Web API"
  ) +
  scale_fill_cyclical(values = c("#de2d26")) +
  theme_ridges() +
  theme(
    plot.title = element_text(
      hjust = 0.5,
      size = 12,
      color = "#000000",
      face = "bold",
      family = "Bitter"
    ),
    plot.title.position = "plot",
    plot.subtitle = element_text(
      face = "italic",
      hjust = 0.5,
      size = 10,
      family = "Bitter"
    ),
    axis.text.y = element_text(size = 10, family = "Raleway"),
    axis.title.x = element_text(
      hjust = 0.5,
      size = 11,
      family = "Raleway"
    ),
    plot.caption = element_text(size = 9, family = "Bitter")
  )


```

```{r}

album_raul |>
  group_by(album) |>
  summarise_at(vars(danceability), list(mediana = ~round(median(., na.rm = TRUE), 3))) |>
  arrange(desc(mediana)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c(
        "compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Mediana da danceability de cada √°lbum da Raul Seixas"
  )

```

####### 

::: {style="text-align: justify;"}
Vimos que a can√ß√£o mais dan√ßante, *O Trem das Sete* pertence ao √°lbum *Gita*, no entanto, √© o √°lbum *Abre-Te S√©samo* que √© o mais dan√ßante, enquanto que o √°lbum *Raulzito e Os Panteras* aparece na √∫ltima posi√ß√£o.

Vamos analisar a `energy` (energia) das m√∫sicas do Raul Rock Seixas. Diferentemente da energia c√≥smica que ele tanto fala, esse atributo √© descrito como *"uma escala de 0 a 1 e representa uma medida de intensidade e atividade. Normalmente, as faixas energ√©ticas parecem r√°pidas, altas e barulhentas". Isso significa que uma faixa bem pesada, como um death metal, teria alta energia, enquanto uma baladinha suave pontua baixo na escala.*

Assim, constatamos que *Soul Tabaroa* √© a m√∫sica mais energ√©tica da colet√¢nia em est√∫dio.
:::

```{r}

album_raul$track_name[which.max(album_raul$energy)]

```

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/5IrRxsDrEJAJgDBqotrVf7?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
```{r}

album_raul |>
  arrange(album_release_year) |>
  mutate(album = factor(album, levels = rev(unique(
    album_raul$album
  )))) |>
  ggplot(aes(x = energy, y = album, fill = album)) +
  geom_density_ridges(
    from = 0,
    to = 1,
    alpha = 1,
    size = 0.1
  ) +
  labs(
    x = "Escala de energia",
    y = "",
    title = "Distribui√ß√£o da energia das m√∫sicas de Raul Seixas por √°lbum",
    subtitle = "Energia: Faixas com maiores n√≠veis de energia s√£o mais r√°pidas e altas e vice-versa",
    caption = "por Majory Melo - @EnigmaMajoris | Fonte: Spotify's Web API"
  ) +
  scale_fill_cyclical(values = c("#4292c6")) +
  theme_ridges() +
  theme(
    plot.title = element_text(
      hjust = 0.5,
      size = 12,
      color = "#000000",
      face = "bold",
      family = "Bitter"
    ),
    plot.title.position = "plot",
    plot.subtitle = element_text(
      face = "italic",
      hjust = 0.5,
      size = 10,
      family = "Bitter"
    ),
    axis.text.y = element_text(size = 10, family = "Raleway"),
    axis.title.x = element_text(
      hjust = 0.5,
      size = 11,
      family = "Raleway"
    ),
    plot.caption = element_text(size = 9, family = "Bitter")
  )

```

```{r}

album_raul |>
  group_by(album) |>
  summarise_at(vars(energy), list(mediana = ~round(median(., na.rm = TRUE), 3))) |>
  arrange(desc(mediana)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c(
        "compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Mediana da energia de cada √°lbum da Raul Seixas"
  )

```

####### 

::: {style="text-align: justify;"}
Mesmo o √°lbum *Sess√£o das 10* tendo a m√∫sica mais energizante das paradas, ele ocupa a 4¬∫ posi√ß√£o no ranking.

Sabemos a partir da an√°lise da mediana da energia que os √°lbuns lan√ßados no per√≠odo entre 1975 e 1977 s√£o os mais energizantes.
:::

### An√°lise das Letras

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Para N√≥ia</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i> "Se eu vejo um papel qualquer no ch√£o / Tremo, corro e apanho pra esconder / Com medo de ter sido uma anota√ß√£o que eu fiz / Que n√£o se possa ler / E eu gosto de escrever, mas..."</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/0K4pBnaHOarmdnLSVdcQIw?si=4095cf5efc0044f7' style='text-decoration: none;'>Novo Aeon, 1975</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

#### An√°lise e tratamento dos dados

-   Analisando o arquivo de m√∫sicas obtidas do site *Letras* `letras.csv`

```{r}

letras <- read_csv("dados/letras.csv")
glimpse(letras)

```

::: {style="text-align: justify;"}
O objeto que geramos na etapa do **Prel√∫dio** (3.1), se mostrou inadequado. Para darmos in√≠cio a nossa an√°lise de texto ser√° preciso ajust√°-lo, de modo que cada linha de verso corresponda a uma linha do arquivo e que o arquivo contenha o nome do alb√∫m e o ano de seu lan√ßamento.
:::

```{r}

head(letras)

```

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Tente outra vez</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Basta ser sincero / E desejar profundo / Voc√™ ser√° capaz de sacudir o mundo / Vai! / Tente outra vez!"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/6YXOsfhu4fDWcHV14tcF3x?si=4581d34c479a4101' style='text-decoration: none;'>Novo Aeon, 1975</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Como n√£o obtive √™xito em ajustar o arquivo `letras.csv` no c√≥digo *R*, resolvi realizar uma nova raspagem, desta vez, utilizando a linguagem *Python*. E agora temos um novo arquivo `raul-letras.csv`, gerado a partir do c√≥digo abaixo, que pelas raz√µes anteriores, encontra-se desabilitado.
:::

``` python
import requests
from bs4 import BeautifulSoup
import pandas as pd

url = 'https://www.letras.mus.br/raul-seixas/'
# Realiza a requisi√ß√£o HTTP para obter o HTML da p√°gina
response = requests.get(url)

# Faz o parsing do HTML com o BeautifulSoup
soup = BeautifulSoup(response.text, 'html.parser')

# Encontra todos os links das m√∫sicas
links = soup.find_all('a', class_='song-name')

# Cria um DataFrame vazio com as colunas 'nome' e 'verso'
df = pd.DataFrame(columns=['nome', 'verso'])

for link in links:
    song_url = link['href']
    song_url2 = "https://www.letras.mus.br"+ song_url
    song_title = link.text.strip()
    song_response = requests.get(song_url2)
    song_soup = BeautifulSoup(song_response.text, 'html.parser')
    lyrics_div = song_soup.find('div', class_='cnt-letra')
    if lyrics_div is not None:
        # Extrai cada verso da letra e adiciona como uma nova linha no DataFrame
        verses = list(lyrics_div.stripped_strings)
        data = {'nome': [song_title] * len(verses), 'verso': verses}
        df = pd.concat([df, pd.DataFrame(data)], ignore_index=True)
    else:
        print(f"N√£o foi poss√≠vel encontrar a letra da m√∫sica '{song_title}'.")

# Salva o DataFrame em um arquivo CSV
df.to_csv('C:/Users/major/Downloads/raul-letras.csv')
```

```{r}

letras_raul <- read.csv("Dados/raul-letras.csv")
glimpse(letras_raul)

```

####### 

::: {style="text-align: justify;"}
De volta √† linguagem *R*, para analisarmos o novo reposit√≥rio `letras_raul`, gerado a partir do arquivo `raul-letras.csv`, percebemos que sa√≠mos de um banco de dados com 251 observa√ß√µes para um com 8.582 linhas. A coluna X, refere-se a contagem das observa√ß√µes.
:::

```{r}

head(letras_raul)

```

####### 

::: callout-important
::: {style="text-align: justify;"}
Para an√°lise das m√∫sicas, consideramos 179 can√ß√µes que foram aquelas que pertencem √† albuns de est√∫dio.

Para a an√°lise das letras de m√∫sicas, vamos considerar tamb√©m as letras de m√∫sicas que foram compostas para serem interpretadas por Raul Seixas, bem como as m√∫sicas compostas por ele pr√≥prio, mas que n√£o necessariamente fazem parte da discografia "*oficial*".

Como √© o caso da m√∫sica [<i>Ainda Queima a Esperan√ßa</i>](https://open.spotify.com/intl-pt/track/4V1qNu3H68Jku5pwyNdIuH?si=eae00f0eff134b37), composta por Raul Seixas e que ficou conhecida na voz de Diana
:::
:::

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/4V1qNu3H68Jku5pwyNdIuH?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
####### 

::: {style="text-align: justify;"}
Antes de analisar o texto, √© preciso fazer alguns ajustes. Vamos criar mais duas colunas `album` e `ano` para identificarmos a qual album a letra pertence e o ano de seu lan√ßamento, isso nos ajudar√° na organiza√ß√£o das visualiza√ß√µes e an√°lises.

Para as letras que n√£o est√£o sendo consideradas na discografia *oficial* vamos atribuir o nome *Composi√ß√µes* na coluna `album` e na coluna `ano` atribuiremos o valor *Sem Informa√ß√£o*. Tamb√©m iremos deixar as letras em formato min√∫scula, na sequ√™ncia faremos a remo√ß√£o de algumas palavras (as *stopwords*) e por fim, o processo de tokeniza√ß√£o.

Criando as colunas `album` e `ano`:
:::

```{r}

letras_raul <- letras_raul %>%
  mutate(album = case_when(
    nome %in% c("Brincadeira", "Por Que, Pra Que?", "Um Minuto Mais", 
                "Vera Verinha", "Voc√™ Ainda Pode Sonhar", 
                "Menina de Amaralina", "Triste Mundo", "D√™-me Tua M√£o", "Alice Maria", 
                "Me Deixa Em Paz", "Trem 103", "O Dorminhoco") ~ "Raulzito e os Panteras - 1968",
    nome %in% c("√äta Vida", "Sess√£o Das Dez", "Eu Vou Botar Pra Ferver", "Eu Acho Gra√ßa", 
                "Chorinho Inconsequente", "Quero Ir", "Soul Tabaroa", "Todo Mundo Est√° Feliz", 
                "Aos Trancos e Barrancos", "Eu N√£o Quero Dizer Nada", "Dr. Pacheco", "Finale") ~ "Sess√£o das 10 - 1971",
    nome %in% c("Rock Around The Clock", "Blue Suede Shoes", 
                "Rock Around The Clock / Blue Suede Shoes / Tutti-Frutti / Long Tall Sally (Medley)", 
                "Rua Augusta / O Bom", "Poor Little Fool / Bernadine (Medley)", 
                "Estupido Cupido / Banho de Lua / Lacinhos Cor de Rosa (Pot-Pourri)",
                "The Great Pretender", "Diana / Little Darlin' / Oh! Carol / Runaway (Medley)", 
                "Marcianita / √â Proibido Fumar / Pega Ladr√£o (Pot-Pourri)", 
                "Jambalaya / Shake, Rattle And Roll / Bop-A-Lena (Medley)", "Only You", 
                "Vem Quente Que Eu Estou Fervendo") ~ "Os 24 Maiores Sucessos da Era do Rock - 1973",
    nome %in% c("Good Rockin' Tonight", "Mosca Na Sopa", "Metamorfose Ambulante", "Dentadura Posti√ßa",
                "As Minas do Rei Salom√£o", "A Hora do Trem Passar", "Al Capone", "How Could I Know", 
                "Rockixe", "Cachorro Urubu", "Ouro de Tolo") ~ "Krig-ha, Bandolo! - 1973",
    nome %in% c("Super-Her√≥is", "Medo da Chuva", "As Aventuras de Raul Seixas Na Cidade de Thor",
                "√Ågua Viva", "Moleque Maravilhoso", "Sess√£o das 10","Sociedade Alternativa", 
                "O Trem Das 7", "S.O.S.", "Prel√∫dio", "Loteria Da Babil√¥nia", "Gita", "Um Som Para Laio",
                "N√£o Pare Na Pista") ~ "Gita - 1974",
    nome %in% c("Tente Outra Vez", "Tente Outra Vez (Vers√£o alternativa)", "Rock do Diabo", "A Ma√ß√£", 
                "Eu Sou Ego√≠sta", "Caminhos", "Tu √âs o MDC da Minha Vida", "A Verdade Sobre a Nostalgia",
                "Paran√≥ia", "Peixuxa", "√â Fim De M√™s", "Sunseed", "Semente do Sol (Sunseed)", 
                "Caminhos II", "Novo Aeon") ~ "Novo Aeon - 1975",
    nome %in% c("Canto Para a Minha Morte", "Meu Amigo Pedro", "Ave Maria da Rua", "Quando Voc√™ Crescer",
                "Dia da Saudade", "Eu Tamb√©m Vou Reclamar", "As Minas do Rei Salom√£o", "O Homem", 
                "Os N√∫meros", "Cantiga de Ninar", "Eu Nasci H√° Dez Mil Anos Atr√°s") ~ "H√° 10 Mil Anos Atr√°s - 1976",
    nome %in% c("My Way / Trouble", "The Diary", "My Baby Left Me / Thirty Days / Rip It Up (Medley)", 
                "All I Have To Do Is Dream / Put Your Head On My Shoulder / Dear Someone", 
                "Do You Know What It Means To Miss New Orleans", 
                "Lucille / Corrine, Corrina (Pot-Pourri)", 
                "Ready Teddy / Hard-Headed Woman / Baby, I Don't Care", "Just Because", 
                "Corrine  Corrina", 
                "Bye Bye Love / Be-Bop-A-Lula / Love Letters In The Sand / Hello Mary Lou", 
                "Blue Moon Of Kentucky") ~ "Raul Rock Seixas - 1977",
    nome %in% c("Tapanacara", "Maluco Beleza", "O Dia Em Que a Terra Parou", 
                "O Dia Em Que a Terra Parou (Vers√£o Alternativa)", "No Fundo do Quintal da Escola", 
                "Eu Quero Mesmo", "Sapato 36", "Voc√™", "Sim", "Que Luz √â Essa?", "De Cabe√ßa Pra Baixo") ~ "O Dia em que a Terra Parou - 1977", 
    nome %in% c("Judas", "Judas (Vers√£o Alternativa)", "As Profecias", "T√° Na Hora", "Planos de Papel", 
                "Conserve Seu Medo", "Neg√≥cio √â", "Mata Virgem", "Pagando Brabo", "Magia de Amor", 
                "Todo Mundo Explica") ~ "Mata Virgem - 1978", 
    nome %in% c("Ide a Mim Dada", "Diamante de Mendigo", "A Ilha da Fantasia", "Na Rodovi√°ria", 
                "Por Quem Os Sinos Dobram", "O Segredo do Universo", "D√°-lhe Que D√°", "Movido a √Ålcool",
                "Requiem Para Uma Flor") ~ "Por Quem os Sinos Dobram - 1979",
    nome %in% c("Abre-te S√©samo", "Aluga-se", "Anos 80", "√Çngela", "Conversa Pra Boi Dormir", 
                "Minha Viola", "Rock Das Aranhas", "O Conto do S√°bio Chin√™s", "S√≥ Pra Variar", "Baby", 
                "√ä Meu Pai", "√Ä Beira do Pantanal") ~ "Abre-te, s√©samo - 1980",
    nome %in% c("D.D.I (Discagem Direta Interestelar)", "D.D.I. (Vers√£o Censurada)", 
                "Coisas do Cora√ß√£o", "Cora√ß√£o Noturno", "N√£o Fosse o Cabral", "Quero Mais", 
                "O Carimbador Maluco", "Lua Cheia", "Segredo da Luz", "Aquela Coisa", 
                "Eu Sou Eu, Nicuri √â o Diabo", "Capim Guin√©", "Babilina", "So Glad You're Mine") ~ "Raul Seixas - 1983",
    nome %in% c("Metr√¥ Linha 743", "Um Messias Indeciso", "Meu Piano", 
                "Quero Ser o Homem Que Sou", "Can√ß√£o do Vento", "Mam√£e Eu N√£o Queria", "Mas I Love You", 
                "Eu sou Ego√≠sta (vers√£o 2)", "O Trem Das 7", "A Gera√ß√£o da Luz", "Anarkilop√≥lis") ~ "Metr√¥ Linha 743 - 1984",
    nome %in% c("Quando Acabar o Maluco Sou Eu", "Anarkil√≥polis (Cowboy Fora Da Lei, parte. 2)", 
                "Paranoia II", "I Am (Gita)", "Cambalache", "Loba", "Cowboy Fora da Lei", 
                "Canceriano Sem Lar (Cl√≠nica Tobias Blues)", "Gente", "Cantar") ~ "Uah-Bap-Lu-Bap-Lah-B√©in-Bum! - 1987",
    nome %in% c("A Pedra do G√™nesis", "A Lei", "Check-Up", "Check-Up (Vers√£o Censurada)",
                "Fazendo o Que o Diabo Gosta", "Cavalos Calados", "N√£o Quero Mais Andar Na Contram√£o", 
                "I Don't Really Need You Anymore", "Lua Bonita", 
                "Senhora Dona Persona (Pesadelo Mitol√≥gico n¬∫ 3)", "Areia da Ampulheta") ~ "A Pedra do G√™nesis - 1988",
    nome %in% c("Be-Bop-A-Lula", "Rock 'n' Roll", "Carpinteiro do Universo", "Quando Eu Morri", 
                "Banquete de Lixo", "Pastor Jo√£o e a Igreja Invis√≠vel", "S√©culo XXI", "Nuit", 
                "Best Seller", "Voc√™ Roubou Meu Videocassete", "C√£imbra No P√©" ) ~ "A Panela do Diabo - 1989",
    TRUE ~ "Composi√ß√µes"  # Para todas as outras linhas, atribua "Composi√ß√µes" na coluna album
  ),
  ano = case_when(
    album == "Raulzito e os Panteras - 1968" ~ "1968",
    album == "Sess√£o das 10 - 1971" ~ "1971",
    album == "Os 24 Maiores Sucessos da Era do Rock - 1973" ~ "1973", 
    album == "Krig-ha, Bandolo! - 1973" ~ "1973",
    album == "Gita - 1974" ~ "1974",
    album == "Novo Aeon - 1975" ~ "1975",
    album == "H√° 10 Mil Anos Atr√°s - 1976" ~ "1976",
    album == "Raul Rock Seixas - 1977" ~ "1977",
    album == "O Dia em que a Terra Parou - 1977" ~ "1977",
    album == "Mata Virgem - 1978" ~ "1978",
    album == "Por Quem os Sinos Dobram - 1979" ~ "1979",
    album == "Abre-te, s√©samo - 1980" ~ "1980",
    album == "Raul Seixas - 1983" ~ "1983",
    album == "Metr√¥ Linha 743 - 1984" ~ "1984",
    album == "Uah-Bap-Lu-Bap-Lah-B√©in-Bum! - 1987" ~ "1987",
    album == "A Pedra do G√™nesis - 1988" ~ "1988",
    album == "A Panela do Diabo - 1989" ~ "1989",
    album == "Composi√ß√µes" ~ "Sem Informa√ß√£o",
    TRUE ~ "NA"  # Para todas as outras linhas, atribua "NA" na coluna ano
  )
)

```

```{r}

head(letras_raul)

```

::: {style="text-align: justify;"}
Convertendo todo o texto da coluna `verso` para letras min√∫sculas:
:::

```{r}

letras_raul <- letras_raul |>
  mutate(verso = tolower(verso))

head(letras_raul$verso)

```

::: {style="text-align: justify;"}
***Stopwords*** s√£o palavras comuns que geralmente s√£o consideradas irrelevantes para a an√°lise de conte√∫do e podem incluir pronomes, artigos, preposi√ß√µes e conjun√ß√µes, etc. O objetivo de filtrar essas palavras √© diminuir o conte√∫do a ser analisado e melhorar sua efici√™ncia.

No *dataframe* h√° m√∫sicas em portugu√™s, espanhol e ingl√™s. Usando a biblioteca `stopwords`, o c√≥digo abaixo criar√° um vetor, `my_stopwords`, que conter√° stopwords padr√£o para os idiomas, al√©m de palavras que acrescentei. Mais pra frente iremos us√°-lo para remover essas palavras.
:::

```{r}

my_stopwords <- c(stopwords("en"), stopwords("pt"), stopwords("es"), "√©", "uh", "yeah", "hey", "baby", "ooh", "wanna", "gonna", "ah", "ahh", "ha", "la", "mmm", "whoa", "haa", "hum!", "hei", "Humrum!", "Uh! Uh! Uh!", "Han!", "Ah!", "oh", "pra", "t√¥", "to", "ai", "ai!", "ei", "i√™h", "√¥h", "u√¥h", "cumqu√™qu√™!", "qu√™n√™u!", "pr√°", "√™h", "i√™", "c√™", "√≥i")

```

####### 

::: {style="text-align: justify;"}
Utilizando o pacote `tidytext` realizaremos o processo de *tokeniza√ß√£o*, que consiste em dividir um texto em unidades menores, chamadas ***Tokens***. Esses *tokens* podem ser palavras √∫nicas, frases, duplas de palavras, partes de palavras, dependendo do n√≠vel de granularidade desejado.

O n√≠vel que desejamos aqui √© dividir cada verso em um *token*, que neste caso, ser√° uma palavra. Resumindo, o c√≥digo far√° que cada palavra fique em uma linha do *dataframe*

Analisando a tabela, temos as colunas: `X`= c√≥digo identificador da m√∫sica; `nome` = nome da m√∫sica; `album` = nome do album incluindo tamb√©m a informa√ß√£o do ano de seu lan√ßamento; `ano` = ano de la√ßamento do album e, `palavra` = cada palavra da m√∫sica isolada em *token*.
:::

```{r}

tidy_letras <- letras_raul
tidy_letras <- tidy_letras |>
  unnest_tokens(palavra, verso)

tidy_letras |>
  head(5) |>
  datatable(
    caption = "Letras de m√∫sicas de Raul Seixas, tokenizadas por palavra"
  )

```

####### 

::: {style="text-align: justify;"}
Chegou a hora de removermos as *stopwords* e as linhas em branco:
:::

```{r}

# Remova as stopwords do objeto tidy_letras$palavra
tidy_letras$palavra <- removeWords(tidy_letras$palavra, c(my_stopwords))

# Remova as linhas em que a palavra seja vazia ap√≥s a remo√ß√£o das stopwords
tidy_letras <- subset(tidy_letras, palavra != "")

```

####### 

::: {style="text-align: justify;"}
Agora que j√° estamos com os dados organizados, vamos tirar algumas percep√ß√µes como, verificar qual m√∫sica √© composta por mais versos, por exemplo.
:::

```{r}

letras_raul |>
  group_by(nome) |>
  summarise(qtd_de_versos = n()) |>
  arrange(desc(qtd_de_versos)) |>
  datatable(
    extensions = c("FixedColumns", "FixedHeader"),
    options = list(
      scrollX = FALSE,
      paging = TRUE,
      fixedHeader = TRUE,
      class = (c(
        "compact", "row-border", "hover", "nowrap"
      ))
    ),
    caption = "Quantidade de versos por m√∫sica na p√°gina do Raul Seixas no site letras.mus.br"
  )

```

####### 

::: {style="text-align: justify;"}
A m√∫sica com mais versos √© *MPB (Sucesso √â a Tua Prova)*, por√©m como consta na pagina do [site](https://www.letras.mus.br/raul-seixas/1321840/), essa m√∫sica n√£o chegou a ser gravada. Ent√£o, considerando a pr√≥xima da lista temos, *Como Vov√≥ J√° Dizia*.

[Como Vov√≥ J√° Dizia](https://pt.wikipedia.org/wiki/Como_Vov%C3%B3_j%C3%A1_Dizia) n√£o pertence a discografia oficial, ela faz parte de um compacto lan√ßado 1974,
:::

```{=html}

<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/3fxlgsDxLanF9ryJea28Ic?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
```
####### 

::: {style="text-align: justify;"}
J√° sabemos qual m√∫sica de Raul tem mais versos, agora vamos descobrir o qu√£o repetitivas s√£o as letras de suas m√∫sicas.

Mas antes, vamos separar as letras *"gringas"* das letras *"brazuca"*.
:::

::: {style="text-align: justify;"}
Criando os reposit√≥rios com as letras de m√∫sicas estrangeiras `letras_gringas` e em portugu√™s `letras_pt`, respectivamente e, exibindo as tr√™s primeiras entradas de cada objeto:
:::

```{r}

# Criando rep√≥sitorio com as letras de m√∫sica em estrangeiras.
# Filtro com todas as m√∫sicas em ingl√™s considerada na an√°lise.

letras_gringas <- tidy_letras |>
  filter(nome %in% c("Ain't She Sweet", "All I Have To Do Is Dream / Put Your Head On My Shoulder / Dear Someone", "Angel",  "A Reluctant Messiah", "Barefoot Ballad", "Blue Moon Of Kentucky", "Blue Suede Shoes", "Bye Bye Love / Be-Bop-A-Lula / Love Letters In The Sand / Hello Mary Lou", "Can't Help Falling In Love", "Diana / Little Darlin' / Oh! Carol / Runaway (Medley)", "Fear Of The Rain", "Fool's Gold", "Good Rockin' Tonight", "Honey Don't", "How Could I Know", "How Could I Know (Love Was To Go)", "I Am (Gita)", "I Don't Really Need You Anymore", "I'll Cry Instead", "Jambalaya / Shake, Rattle And Roll / Bop-A-Lena (Medley)", "Just Because", "Kansas City", "Let Me Sing, Let Me Sing", "Love Is Magick", "Love Is Magick (II version)", "Lucille / Corrine, Corrina (Pot-Pourri)", "Metamorfose Ambulante (Espanhol)", "Morning Train", "My Baby Left Me / Thirty Days / Rip It Up (Medley)", "My Way / Trouble", "Only You", "Orange Juice (S.O.S)", "Ouro de Tolo (versi√≥n en espa√±ol)", "Poor Little Fool / Bernadine (Medley)", "Ready Teddy / Hard-Headed Woman / Baby, I Don't Care", "Rock Around The Clock", "Rock Around The Clock / Blue Suede Shoes / Tutti-Frutti / Long Tall Sally (Medley)", "Roll Over Beethoven", "So Glad You're Mine", "Sunseed", "The Apple", "The Diary", "The Great Pretender", "Wee Wee Hours", "White Wings" )) |>
  arrange(ano)
  head (letras_gringas, n=3)
  
# Criando rep√≥sitorio com as letras de m√∫sica em portugu√™s

letras_pt <- tidy_letras |>
  filter(!nome %in% letras_gringas$nome) |>
  arrange(ano)
  head (letras_pt, n=3)


```

####### 

::: {style="text-align: justify;"}
Nos anos de 1973 e 1977, Raul Seixas lan√ßou dois √°lbuns de est√∫dios (*Os 24 Maiores Sucessos da Era do Rock* e *Raul Rock Seixas*, nesta ordem) apenas com m√∫sicas covers de seu grande √≠dolo e influenciador ***Elvis Presley*** e outros artitas nacionais e internaconais da *Era* popularmente conhecida como a *Jovem Guarda*.

Para an√°lisar as composi√ß√µes de Raulzito e as letras que foram feitas exclusivamente para serem interpretadas por ele, iremos ajustar os reposit√≥rios `letras_pt` e `letras_gringas` para desconsiderar as m√∫sicas desses dois √°lbuns e quais letras estrangeiras devemos considerar.

Por fim, geraremos o gr√°fico *Boxplot* para fazer a compara√ß√£o dos albuns em rela√ß√£o a varia√ß√µes l√©xicas.
:::

```{r}

# Filtrar as linhas indesejadas do dataframe letras_pt
letras_pt_filtrado <- letras_pt |>
  filter(album != "Os 24 Maiores Sucessos da Era do Rock - 1973",
         album != "Raul Rock Seixas - 1977")

# Filtrar as linhas desejadas do dataframe letras_gringas
letras_gringas_filtrado <- letras_gringas |>
  filter(nome %in% c("How Could I Know", "Sunseed", "So Glad You're Mine", "I Am (Gita)", 
                     "I Don't Really Need You Anymore", "The Apple", "A Reluctant Messiah", "Angel",
                     "Fear Of The Rain", "Fool's Gold", "Let Me Sing, Let Me Sing", "Love Is Magick",
                     "Morning Train", "Orange Juice (S.O.S)"))

# Combinar os dataframes filtrados
lexical <- rbind(letras_pt_filtrado, letras_gringas_filtrado) |>
  group_by(nome, album, ano) |>
  mutate(lex_div = length(unique(palavra)) / length(palavra)) |>
  select(nome, lex_div, album) |>
  distinct()

# Ordenar o dataframe pela coluna "ano"
lexical <- lexical |>
  arrange(ano)

# Criar o gr√°fico usando ggplot2
p <- ggplot(lexical, aes(x = ano, y = lex_div, fill = album)) +
  geom_jitter(position = position_dodge(width = 0.2), alpha = 0.7) +
  geom_boxplot(width = 0.2, outlier.shape = NA, position = position_dodge(width = 0.2)) +
  geom_hline(yintercept = mean(lexical$lex_div), linetype = "dashed", color = "blue") +
  labs(x = "Ano de Lan√ßamento", y = "Varia√ß√µes L√©xicas", 
       caption = "por Majory Melo - @EnigmaMajoris")+
  scale_fill_discrete() +  # Utilizar paleta de cores padr√£o
  guides(fill = guide_legend(nrow = 4)) +  # Dividir a legenda em duas linhas
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
        legend.position = "top", 
        legend.title = element_blank(),
        legend.text = element_text(size = 6),
        legend.box.background = element_rect(color = "black"))

# Exibir o gr√°fico
print(p)

```

####### 

::: {style="text-align: justify;"}
O gr√°fico nos mostra que ter muitos dados abaixo da linha da mediana significa que as letras das m√∫sicas t√™m poucas variedades l√©xicas, ou seja, s√£o mais repetitivas. No caso dos √°lbuns *A Panela do Diabo - 1989*, *Krig-ha, Bandolo! - 1973* e *Gita - 1974*, s√£o √°lbuns que possuem m√∫sicas mais pop como *Be-Bop-A-Lula*, *Metamorfose Ambulante* e *Gita*. Esses √°lbuns apresentarem baixa variedade l√©xica, faz sentido, j√° que as can√ß√µes pop s√£o tradicionalmente repetitivas tanto musical quanto liricamente, e √© isso que as tornam "chiclete".

O √°lbum *Por quem os Sinos Dobram - 1979* nos mostra que muitas m√∫sicas possuem uma variedade maior de palavras √∫nicas em rela√ß√£o ao total de palavras. O que tamb√©m faz todo o sentido, j√° que esse √°lbum foi lan√ßado numa √©poca que a popularidade do Raul n√£o estava mais em alta. As m√∫sicas deste √°lbum apresentam um vocabul√°rio mais diversificado e menos repetitivo. Como √© o caso das m√∫sicas *Diamante de Mendigo* e *Por quem os Sinos Dobram*, que d√° nome ao disco.

J√° o √°lbum *Uah-Bap-Lu-Bap-Lah-B√©in-Bum! - 1987* √© o que se mostra mais equilibrado diante da varidade de palavras. E novamente, o gr√°fico confirma aquilo que j√° √© sabido. O Lan√ßamento deste √°lbum marca o retorno de Raul Seixas ao sucesso, depois de tr√™s anos do seu √∫ltimo lan√ßamento (*Metr√¥ Linha 743 - 1984*).

O Lan√ßamento de 87, traz m√∫sicas pop como *Cowboy Fora da Lei* que, inclusive virou trilha sonora de novela (*Brega & Chique*) e m√∫sicas menos repetitivas como *Gente*. O √°lbum foi muito importante na retomada art√≠stica de Raul, lhe rendendo at√© um Disco de Ouro, o terceiro de sua carreira.

Acabamos de ver o quanto os discos s√£o repetitivos. Mas qual ser√° a palavra mais dita por Raul Seixas? Bora descobrir?
:::

::: {style="text-align: center;font-weight: bold; font-size: 26px; font-family: Bradley Hand ITC;"}
Palavras mais frequentes nas letras de Raul Seixas
:::

```{r}

# Filtrar apenas as palavras com ocorr√™ncias iguais ou maiores que 100
palavra_counts <- letras_pt_filtrado |>
  count(palavra, sort = TRUE) |>
  filter(n >= 120)

# Criar o gr√°fico usando highcharter
p_1 <- 
  highchart()|>
  hc_chart(type = "column") |>
  hc_xAxis(categories = palavra_counts$palavra) |>
  hc_add_series(data = palavra_counts$n, name = "N√∫mero de vezes mencionadas", colorByPoint = TRUE) |>
  hc_plotOptions(column = list(dataLabels = list(enabled = TRUE, color = "white", 
                                                 style = list(textOutline = "none")))) |>
  hc_subtitle(text = "M√∫sicas em portugu√™s") |>
  hc_yAxis(title = list(text = "N√∫mero de vezes mencionadas")) |>
  hc_credits(enabled = TRUE, text = "por Majory Melo - @EnigmaMajoris") |>
  hc_colors(c("#009B3A", "#FFD500"))

p_1

```

```{r}
  
# Filtrar apenas as palavras com ocorr√™ncias iguais ou maiores que 100
word_counts <- letras_gringas_filtrado |>
  count(palavra, sort = TRUE) |>
  filter(n > 16)

# Criar o gr√°fico usando highcharter
p_2 <- 
  highchart()|>
  hc_chart(type = "column") |>
  hc_xAxis(categories = word_counts$palavra) |>
  hc_add_series(data = word_counts$n, name = "N√∫mero de vezes mencionadas", colorByPoint = TRUE) |>
  hc_plotOptions(column = list(dataLabels = list(enabled = TRUE, color = "white", 
                                                 style = list(textOutline = "none")))) |>
  hc_subtitle(text = "M√∫sicas em ingl√™s") |>
  hc_yAxis(title = list(text = "N√∫mero de vezes mencionadas")) |>
  hc_credits(enabled = TRUE, text = "por Majory Melo - @EnigmaMajoris") |>
  hc_colors(c("#3c3b6e", "#b22234"))

p_2

```

####### 

::: {style="text-align: center;font-weight: bold; font-size: 26px; font-family: Bradley Hand ITC;"}
Palavras mais frequentes na discografia de Raul Seixas
:::

```{r}

nuvem <- tidy_letras |>
  filter(album != "Composi√ß√µes") |>
  group_by(palavra) |>
  summarise(freq = n()) |>
  arrange(desc(freq))
nuvem <- na.omit(nuvem)

nuvem |>
  filter(freq > 15) |>
  wordcloud2(
    size = 0.5,
    minSize = 0.5,
    gridSize = 0.6,
    fontFamily = "Bitter",
    fontWeight = "bold",
    color = c("#bd93bd", "#faa275", "#44a6b7", "#ee316b", "#885053","#842d72", "#fdb137","#bd93bd",
              "#8ac6d0", "#f4bcc4", "#235760", "#777da7", "#94c9a9", "#9A373F", "#FF6600", "#00CC66",
              "#3366CC", "#666666", "#FFCC00", "#663300", "#660099", "#DCA9FF", "#A7E6C8", "#DCA9FF" ),
    backgroundColor = "white",
    minRotation = -pi / 4,
    maxRotation = pi / 4,
    shuffle = FALSE,
    rotateRatio = 0,
    shape = "circle",
    ellipticity = 1,
    widgetsize = NULL,
    figPath = NULL,
    hoverFunction = NULL
  )

```

####### 

::: {style="text-align: justify;"}
Ah o amor... Amor √© uma palavra recorrente em suas m√∫sicas em ambos idiomas. Mas, ser√° que o sentimento amor se faz presente nas suas composi√ß√µes? Se sim, ser√° que √© retratado de uma forma positiva ou negativa?
:::

#### Sentimentos

::: {style="text-align: justify;"}
O pacote `tidytext` possui a fun√ß√£o `getsentiments()`que possui atualmente tr√™s tipos de l√©xicos, `afinn`, `bing` e `nrc`, que nos permite trabalhar com an√°lise de texto de forma estruturada e eficiente.

O l√©xico `afinn`, desenvolvido por @Nielsen faz uso de escala de pontua√ß√£o que vai do **-5** a **5** para determinar o quanto uma palavra √© positiva ou negativa. Enquanto que o `bing` de @Bing, consiste em caracterizar a palavra em **positiva** ou **negativa**. J√° o `nrc` criado por @nrc categoriza palavras de forma bin√°ria ("sim"/"n√£o") em categorias de **positivo**, **negativo**, **raiva**, **antecipa√ß√£o/expectativa**, **avers√£o/nojo**, **medo**, **alegria**, **tristeza**, **surpresa** e **confian√ßa**.

A figura a seguir demostra como realizar a an√°lise do sentimento com o pacote `tidytext`.

[![Fluxo de an√°lise de texto com o pacote tidytext (Imagem: Reprodu√ß√£o/tidytextmining.com)](imagem/tidytex.png){fig-align="center"}](https://www.tidytextmining.com/sentiment.html)

Se quiser saber mais detalhes, vale a pena dar uma conferida nesse [material](https://www.tidytextmining.com/sentiment.html).

Como pode ser observado na figura do fluxograma da an√°lise de texto, n√≥s j√° temos at√© aqui os dados das nossas letras *tokenizados* e s√≥ nos falta selecionar as letras que vamos analisar.

Como os l√©xicos da fun√ß√£o `getsentiments()` funcionam melhor em ingl√™s, para fazer a an√°lise do sentimento, escohi analisar 4 m√∫sicas que possuem vers√£o em portugu√™s e ingl√™s e, que tamb√©m s√£o conhecidas do grande p√∫blico *(talvez pelo t√≠tulo voc√™ n√£o as reconhe√ßa mas se ouvir, certamente reconhecer√° a melodia ou algum trecho da m√∫sica)*.

|      Ingl√™s      |   Portugu√™s   |
|:----------------:|:-------------:|
| Fear Of The Rain | Medo da Chuva |
|   Fool's Gold    | Ouro de Tolo  |
|   I am (Gita)    |     Gita      |
|    The Apple     |    A ma√ß√£     |

: Letras selecionadas para an√°lise de sentimentos

Para dar in√≠cio a nossa an√°lise de sentimentos, iremos criar um novo reposit√≥rio para filtr√°-las do repos√≠t√≥rio `letras_gringas_filtrado`.
:::

```{r}

raul_sentiment <- letras_gringas |>
  filter(nome %in% c("I Am (Gita)", "Fear Of The Rain", "Fool's Gold", 
                     "The Apple")) |>
  rename(word = palavra)

str(raul_sentiment)

```

::: {style="text-align: justify;"}
A partir do reposit√≥rio `letras_gringas_filtrado` criamos o reposit√≥rio `raul_sentiment`, onde al√©m de inclu√≠mos as m√∫sicas selecionadas, alteramos o nome da coluna `palavra` para `word` de modo a permitir que a fun√ß√£o `inner_join()` funcione adequadamente com as bases de dados de sentimentos definida para cada l√©xico.

o primeiro l√©xico que vamos analisar √© o `afinn`
:::

```{r}

raul_afinn <- raul_sentiment |>
   inner_join(get_sentiments("afinn"), by = "word")

# Total de palavras por m√∫sica que foram consideradas na an√°lise 
dim <- raul_afinn |>
  count(nome) 

raul_afinn |>
  group_by(nome) |>
  summarise(total_score = sum(value)) |>
  ggplot(aes(x = nome, y = total_score, fill = nome)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(limits = c(-50, 50), breaks = seq(-50, 50, by = 10)) + 
  coord_flip() +
  theme_fivethirtyeight() +
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        plot.title = element_text(size = rel(1.2), hjust = 0.5)) +
  scale_fill_manual(values = c("palevioletred", "olivedrab3","lightpink",
                               "mediumseagreen")) +
  theme(legend.position = "none") +
  labs(title = "An√°lise de Sentimento das M√∫sicas de Raul Seixas",
       x = "M√∫sica",
       y = "Pontua√ß√£o de Sentimento",
       caption = "por Majory Melo - @EnigmaMajoris")

```

::: {style="text-align: justify;"}
O gr√°fico nos mostra que as m√∫sicas [*The Apple*](https://www.letras.mus.br/raul-seixas/1506748/) */ [A Ma√ß√£](https://www.letras.mus.br/raul-seixas/48293/)* e [*Fool's Gold*](https://www.letras.mus.br/raul-seixas/442411/) */ [Ouro de Tolo](https://www.letras.mus.br/raul-seixas/48326/)* s√£o as mais ***positivas***, enquanto que [*Fear Of The Rain*](https://www.letras.mus.br/raul-seixas/1702884/) */ [Medo da Chuva](https://www.letras.mus.br/raul-seixas/48316/)* √© a m√∫sica mais ***negativa*** da nossa sele√ß√£o.

Com aux√≠lio de um gr√°fico feito com o l√©xico `bing` vamos ver mais no detalhe as caracter√≠sticas dessas m√∫sicas.

No gr√°fico, cada medida num√©rica representa uma palavra, j√° que o l√©xico `bing` usa as categorias "positivo" e "negativo" em vez da escala de pontua√ß√£o.
:::

```{r}
raul_bing <- raul_sentiment |> 
  inner_join(get_sentiments("bing"), by = "word")

sentiment_bing <- raul_bing |> 
  unique() |> 
  group_by(nome, sentiment) |> 
  count(nome, sentiment)

for(i in 1:8) {
  if(sentiment_bing$sentiment[i] == "negative")
    sentiment_bing$n[i] <- -sentiment_bing$n[i]
}

sentiment_bing |> 
  ggplot(aes(x = nome, y = n, fill = sentiment)) + 
  geom_bar(stat = "identity") +
  scale_y_continuous(limits = c(-25, 25), breaks = seq(-25, 25, 5)) +
  coord_flip() +
  theme_fivethirtyeight() +
  theme(panel.background = element_rect(fill = "white"),
        plot.background = element_rect(fill = "white"),
        plot.title = element_text(size = rel(1.2), hjust = 0.5)) + 
  scale_fill_manual(values = c("palevioletred", "olivedrab3")) +
  labs(title = "An√°lise de Sentimento das M√∫sicas de Raul Seixas",
       x = "M√∫sica",
       y = "Contagem",
       caption = "por Majory Melo - @EnigmaMajoris") +
  theme(legend.position = "none")

```

::: {style="text-align: justify;"}
Analisando as m√∫sica sob a √≥tica do l√©xico `bing` notamos que [*Fool's Gold*](https://www.letras.mus.br/raul-seixas/442411/) */ [Ouro de Tolo](https://www.letras.mus.br/raul-seixas/48326/)* possui 8 palavras classificadas como tendo sentimento negativo contra 23 palavras positiva, caracterizando-a como uma m√∫sica muito ***positiva***.

J√° [*Fear Of The Rain*](https://www.letras.mus.br/raul-seixas/1702884/) */ [Medo da Chuva](https://www.letras.mus.br/raul-seixas/48316/)*, est√° classificada como ***negativa*** por ter mais da metada das palavras analisadas classificadas como sendo do tipo negativo.

O ponto interessante aqui, √© que a m√∫sica [*I Am (Gita)*](https://www.letras.mus.br/raul-seixas/80425/) */ [Gita](https://www.letras.mus.br/raul-seixas/48312/)* na an√°lise `afinn` se mostrou com um sentimento ***positivo***, enquanto que na vis√£o `bing` ela √© classificada como ***negativa***. O que at√© soa compreens√≠vel, j√° que se trata de uma uma m√∫sica com termos muito contradit√≥rios e o quanto a m√∫sica tende para um lado depender√° das caracter√≠sticas de cada regra de an√°lise. Reparem nos versos que selecionei:
:::

```{=html}

<div style='border: 4px solid #f4a385; border-radius: 15px; padding: 7px; background-color: #f3efe6; display: inline-block; font-family: Calibri;'>
  <font color='#c69888' size='4'>
    <div style='text-align: left;'>
      <b>Gita</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #f4a385; border-radius: 14px; padding: 4px;
background-color: #f3efe6'>
  <font color='b3bdb4' size='3'>
    <div style='text-align: left;'>
      <i><b>Eu sou o medo do fraco / A for√ßa da imagina√ß√£o / O blefe do jogador / Eu sou, eu fui, eu vou /... / Eu sou a vela que acende / Eu sou a luz que se apaga /Eu sou a beira do abismo / Eu sou o tudo e o nada" / ... / Voc√™ me tem todo dia / Mas n√£o sabe se √© bom ou ruim / Mas saiba que eu estou em voc√™ / Mas voc√™ n√£o est√° em mim</i></b> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/4AtL1paTEV1AXUmj3c4GTI?si=f77955baabf747c8' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Em ambas an√°lises [*The Apple*](https://www.letras.mus.br/raul-seixas/1506748/) */ [A Ma√ß√£](https://www.letras.mus.br/raul-seixas/48293/)* √© classificada como ***positiva***.

Os l√©xicos `afinn` e `bing` s√£o restritos, pois fornecem apenas sentimentos bin√°rios. O l√©xico `nrc`, por outro lado, permite a classifica√ß√£o de palavras em oito categorias emocionais: **raiva**, **antecipa√ß√£o/expectativa**, **avers√£o/nojo**, **medo**, **alegria**, **tristeza**, **surpresa** e **confian√ßa**.

Escolhi demonstrar a an√°ise `nrc` por meio de um gr√°fico de radar, tamb√©m conhecido como gr√°fico de teia. Optei tamb√©m, por deixar os sentimentos positivos do lado direito e os n√£o-positivos no lado esquerdo.
:::

```{r}

# Selecionar as m√∫sicas
raul_nrc <- raul_sentiment |>
  inner_join(get_sentiments("nrc"), by = "word") |>
  filter(!sentiment %in% c("positive", "negative")) 

# Criar Mapa de Sentimento
sentiment_nrc <- raul_nrc |>
  group_by(nome, sentiment) |>
  count(nome, sentiment) |>
  select(nome, sentiment, sentiment_total = n)

nome_nrc <- raul_nrc |>
  count(nome) |>
  select(nome, nome_total = n)

mapa <- sentiment_nrc |> 
  inner_join(nome_nrc, by = "nome") |>
  mutate(percent = round((sentiment_total/nome_total * 100), 3)) |>
  select(-sentiment_total, -nome_total) |>
  spread(nome, percent)

# Transformar o arquivo em um dataframe 
mapa_df <- as.data.frame(t(mapa[, -1]))

# Atribuir ao nome das vari√°veis as linhas da coluna sentiment da tabela mapa 
colnames(mapa_df) <- mapa$sentiment

# Substituir os valores NA por zero
mapa_df[is.na(mapa_df)] <- 0

# Definir valores max√≠mo e m√≠nimo e, vincular as vari√°veis novas ao dataframe mapa_df
max_min <- data.frame(
  anticipation = c(40, 0),
  sadness = c(40, 0),
  anger = c(40, 0), 
  disgust = c(40, 0),
  fear = c(40, 0),
  trust = c(40, 0),
  joy = c(40, 0),
  surprise = c(40, 0))
rownames(max_min) <- c("Max", "Min")
mapa_df <- rbind(max_min, mapa_df)

```

::: {style="text-align: justify;"}
Para a cria√ß√£o do ***Radar de Sentimentos*** tive que realizar os seguintes tratamentos de dados:

Transformei o objeto resultante da an√°lise em um dataframe e atribui valores de m√≠nimo igual a zero e m√°ximo igual a 40, que representa a pontua√ß√£o dos sentimentos. Al√©m disso, substitui os valores *NA* por zero.

E o resultado s√£o os gr√°ficos abaixo:
:::

::: {style="text-align: center;font-weight: bold; font-size: 26px; font-family: Bradley Hand ITC;"}
Radar de Sentimentos
:::

```{r}

# Definir as cores e os t√≠tulos
cores <- c("cadetblue", "palevioletred", "purple","black")
titulo <- c("Fear Of The Rain \nMedo da Chuva", "Fool's Gold \nOuro de Tolo", 
            "I Am (Gita) \nGita", "The Apple \nA Ma√ß√£")

# Ajustar o tamanho da exibi√ß√£o dos gr√°ficos usando par() e dividindo em 2 partes
op <- par(mfrow = c(2, 2), mar = c(0.8, 3, 3, 0.8))

# Criar gr√°fico
for(i in 1:4){
  radarchart(
    df = mapa_df[c(1, 2, i+2), ], 
    caxislabels = c(0, 5, 10, 15, 20, 25, 30, 35, 40),
    pcol = cores[i],
    pfcol = adjustcolor(cores[i], alpha = 0.2),
    plwd = 3,
    cglty = 1,
    cglwd = 2,
    cglcol = "grey",
    vlcex = 0.8,
    title = titulo[i]
  )
}
   
par(op)

```

```{=html}

<div style='border: 4px solid #f4a385; border-radius: 15px; padding: 7px; background-color: #f3efe6; display: inline-block; font-family: Calibri;'>
  <font color='#c69888' size='4'>
    <div style='text-align: left;'>
      <b>Medo da Chuva</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #f4a385; border-radius: 14px; padding: 4px;
background-color: #f3efe6'>
  <font color='235760' size='3'>
    <div style='text-align: left;'>
      <i><b>√â pena que voc√™ pense / Que eu sou seu escravo / Dizendo que eu sou seu marido / E n√£o posso partir / Como as pedras im√≥veis na praia / Eu fico ao seu lado sem saber / Dos amores que a vida me trouxe / E eu n√£o pude viver / Eu perdi o meu medo / O meu medo, o meu medo da chuva / Pois a chuva voltando / Pra terra traz coisas do ar / Aprendi o segredo, o segredo / O segredo da vida / Vendo as pedras que choram sozinhas / No mesmo lugar / Eu n√£o posso entender / Tanta gente aceitando a mentira / De que os sonhos desfazem aquilo / Que o padre falou / Porque quando eu jurei meu amor / Eu tra√≠ a mim mesmo, hoje eu sei / Que ningu√©m nesse mundo / √â feliz tendo amado uma vez / Uma vez</i></b> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/4AtL1paTEV1AXUmj3c4GTI?si=f77955baabf747c8' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
A m√∫sica [*Fear Of The Rain*](https://www.letras.mus.br/raul-seixas/1702884/) */ [Medo da Chuva](https://www.letras.mus.br/raul-seixas/48316/)* tanto na an√°lise `afinn` como `bing` foi classificada como ***negativa***. Na an√°lise `nrc` percebemos que os sentimentos que prevalecem s√£o ***tristeza***, ***raiva***, ***medo***, ***confian√ßa***. Sentimentos que corroboram as an√°lises feitas e com o contexto da letra.

A m√∫sica fala sobre o medo em quebrar os acordo sociais, neste caso representado pelo casamento. E, ao perder o medo da chuva, Raul afirma que est√° pronto para buscar aquilo que lhe far√° bem, ser uma nova vers√£o.
:::

```{=html}

<div style='border: 4px solid #f4a385; border-radius: 15px; padding: 7px; background-color: #f3efe6; display: inline-block; font-family: Calibri;'>
  <font color='#c69888' size='4'>
    <div style='text-align: left;'>
      <b>Ouro de Tolo</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #f4a385; border-radius: 14px; padding: 4px;
background-color: #f3efe6'>
  <font color='235760' size='3'>
    <div style='text-align: left;'>
      <i><b>Eu devia estar contente / Porque eu tenho um emprego / Sou um dito cidad√£o respeit√°vel / E ganho quatro mil cruzeiros por m√™s / Eu devia agradecer ao Senhor por ter tido sucesso / Na vida como artista / Eu devia estar feliz / Porque consegui comprar Um Corcel 73 / Eu devia estar alegre e satisfeito / Por morar em Ipanema depois de ter passado fome / Por dois anos aqui na Cidade Maravilhosa / 
Ah! Eu devia estar sorrindo e E orgulhoso / Por ter finalmente vencido na vida / Mas eu acho isso uma grande piada e um tanto quanto perigosa / Eu devia estar contente / Por ter conseguido / Tudo o que eu quis / Mas confesso abestalhado / Que eu estou decepcionado / Porque foi t√£o f√°cil conseguir / E agora eu me pergunto "E da√≠?" / Eu tenho uma por√ß√£o / De coisas grandes pra conquistar / E eu n√£o posso ficar a√≠ parado / Eu devia estar feliz pelo Senhor / Ter me concedido o domingo
Pra ir com a fam√≠lia / No Jardim Zool√≥gico / Dar pipoca aos macacos / Ah! Mas que sujeito chato sou eu / Que n√£o acha nada engra√ßado / Macaco, praia, carro, jornal, tobog√£ / Eu acho tudo isso um saco / √â voc√™ olhar no espelho / Se sentir um grandess√≠ssimo idiota / Saber que √© humano / Rid√≠culo, limitado que s√≥ usa dez por cento de sua cabe√ßa animal / E voc√™ ainda acredita / Que √© um doutor / Padre ou policial / Que est√° contribuindo / Com sua parte para o nosso belo quadro social / Eu √© que n√£o me sento / No trono de um apartamento / Com a boca escancarada / Cheia de dentes / Esperando a morte chegar / Porque longe das cercas embandeiradas / Que separam quintais / No cume calmo / Do meu olho que v√™ / Assenta a sombra sonora / De um disco voador</i></b> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/album/2xRddGxRH0KdDWLNE5b0iu?si=MwcD18cnRkebydaj95twow' style='text-decoration: none;'>Krig-ha, Bandolo!, 1973</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Por outro lado, em [*Fool's Gold*](https://www.letras.mus.br/raul-seixas/442411/) */ [Ouro de Tolo](https://www.letras.mus.br/raul-seixas/48326/)* o resultado das an√°lises nos diz que trata-se de uma letra positiva e que os sentimentos que se destacam s√£o ***antecipa√ß√£o/expectativa***, ***alegria*** e ***confian√ßa***.

No entanto, o contexto da m√∫sica nos mostra o sentimento de ***decep√ß√£o*** e ***insatisfa√ß√£o*** do artista por mesmo ter conseguido conquistar tudo o que queria ele ainda n√£o se sente realizado.
:::

```{=html}

<div style='border: 4px solid #f4a385; border-radius: 15px; padding: 7px; background-color: #f3efe6; display: inline-block; font-family: Calibri;'>
  <font color='#c69888' size='4'>
    <div style='text-align: left;'>
      <b>Gita</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #f4a385; border-radius: 14px; padding: 4px;
background-color: #f3efe6'>
  <font color='235760' size='3'>
    <div style='text-align: left;'>
      <i><b>Eu, que j√° andei pelos quatro cantos do mundo procurando / Foi justamente num sonho que Ele me falou / √Äs vezes voc√™ me pergunta / Por que √© que eu sou t√£o calado / N√£o falo de amor quase nada /Nem fico sorrindo ao teu lado / Voc√™ pensa em mim toda hora / Me come, me cospe, me deixa / Talvez voc√™ n√£o entenda / Mas hoje eu vou lhe mostrar / Eu sou a luz das estrelas / Eu sou a cor do luar /Eu sou as coisas da vida / Eu sou o medo de amar / Eu sou o medo do fraco / A for√ßa da imagina√ß√£o / O blefe do jogador / Eu sou, eu fui, eu vou / Eu sou o seu sacrif√≠cio / A placa de contram√£o / O sangue no olhar do vampiro / E as juras de maldi√ß√£o / Eu sou a vela que acende / Eu sou a luz que se apaga / Eu sou a beira do abismo / Eu sou o tudo e o nada / Por que voc√™ me pergunta? / Perguntas n√£o v√£o lhe mostrar / Que eu sou feito da terra / Do fogo, da √°gua e do ar / Voc√™ me tem todo dia / Mas n√£o sabe se √© bom ou ruim / Mas saiba que eu estou em voc√™ / Mas voc√™ n√£o est√° em mim / Das telhas, eu sou o telhado / A pesca do pescador / A letra A tem meu nome / Dos sonhos, eu sou o amor / Eu sou a dona de casa / Nos pegue-pagues do mundo / Eu sou a m√£o do carrasco / Sou raso, largo, profundo / Eu sou a mosca da sopa / E o dente do tubar√£o / Eu sou os olhos do cego / E a cegueira da vis√£o / Eu, mas eu sou o amargo da l√≠ngua / A m√£e, o pai e o av√¥ / O filho que ainda n√£o veio
O in√≠cio, o fim e o meio / O in√≠cio, o fim e o meio / Eu sou o in√≠cio, o fim e o meio / Eu sou o in√≠cio, o fim e o meio</i></b> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/4AtL1paTEV1AXUmj3c4GTI?si=f77955baabf747c8' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Como j√° pontuado anteriormente, [*I Am (Gita)*](https://www.letras.mus.br/raul-seixas/80425/) */ [Gita](https://www.letras.mus.br/raul-seixas/48312/)* se mostrou ***positiva*** na an√°lise `afinn` e ***negativa*** sob a an√°lise `bing`. Na an√°lise `nrc` a m√∫sica apresenta sentimentos equilibrados tendendo mais para os sentimentos de ***anteciapa√ß√£o/expectativa***, ***tristeza*** e ***medo***.

Acredito que a m√∫sica se enquadrou melhor na an√°lise `nrc`, por todos os pontos j√° discutidos.
:::

```{=html}

<div style='border: 4px solid #f4a385; border-radius: 15px; padding: 7px; background-color: #f3efe6; display: inline-block; font-family: Calibri;'>
  <font color='#c69888' size='4'>
    <div style='text-align: left;'>
      <b>A Ma√ß√£</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #f4a385; border-radius: 14px; padding: 4px;
background-color: #f3efe6'>
  <font color='235760' size='3'>
    <div style='text-align: left;'>
      <i><b>Se esse amor / Ficar entre n√≥s dois / Vai ser t√£o pobre amor / Vai se gastar / Se eu te amo e tu me amas / Um amor a dois profana / O amor de todos os mortais / Porque quem gosta de ma√ß√£ / Ir√° gostar de todas / Porque todas s√£o iguais / Se eu te amo e tu me amas / E outro vem quando tu chamas / Como poderei te condenar / Infinita tua beleza / Como podes ficar presa / Que nem santa num altar / Quando eu te escolhi / Para morar junto de mim / Eu quis ser tua alma / Ter seu corpo, tudo enfim / Mas compreendi / Que al√©m de dois existem mais / Amor s√≥ dura em liberdade / O ci√∫me √© s√≥ vaidade / Sofro, mas eu vou te libertar / O que √© que eu quero / Se eu te privo / Do que eu mais venero / Que √© a beleza de deitar</i></b> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/album/3hgOfaE0yiMg511d0Y1JfJ?si=WIHZGg4YQ6iOYXlIGjqAiA' style='text-decoration: none;'>Novo Aeon, 1975</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
A an√°lise da m√∫sica [*The Apple*](https://www.letras.mus.br/raul-seixas/1506748/) */ [A Ma√ß√£](https://www.letras.mus.br/raul-seixas/48293/)* foi a que mais me causou estranheza. Sob as tr√™s an√°lises o resultado foi ***positivo*** tendo enfoque para o sentimento de ***alegria***. No entanto, o contexto da m√∫sica nos remete a outros sentimentos como ***decep√ß√£o*** e ***conformismo***.

Entendo que palavras como ***amor***, ***beleza*** e ***liberdade*** trazem o sentido positivo e que elas se repetem ao longo da m√∫sica. Mas, o contexto da m√∫sica, fala sobre trai√ß√£o num relacionamento, achar consolo na cren√ßa de que o amor √© livre e que devemos sempre fazer o que gostamos.
:::

#### Correla√ß√£o das m√∫sicas

::: {style="text-align: justify;"}
Para encerrarmos a an√°lise das Letras faremos um *mapa de correla√ß√£o* para analisarmos a correla√ß√£o existente entre as m√∫sicas pertencentes aos √°lbuns de est√∫dio de Raul Seixas.

Criei um novo *dataframe* `raul_cor` que cont√©m apenas as m√∫sicas em portugu√™s dos √°lbuns de est√∫dios. Tamb√©m retirei da base, m√∫sicas que cont√©m mais de uma vers√£o, como *vers√£o censurada*, por exemplo.

Utilizando a fun√ß√£o `pairwise_cor()` iremos comparar todas as m√∫sicas selecionadas atrav√©s das palavras que elas cont√©m.

Correla√ß√µes muitas baixas far√° com que o mapa fique ileg√≠vel, por isso optei por correla√ß√µes maior que 0.13.

A escolha do n√∫mero *13* n√£o foi ao acaso, foi escolhido para representar o sentimento *esquerdista e anarquista* de Raul Seixas. 
:::

```{r}

raul_cor <- letras_pt_filtrado %>%
  filter(album != "Composi√ß√µes",
         !grepl("vers√£o", nome, ignore.case = TRUE)) |>
  pairwise_cor(nome, palavra, sort = TRUE)

raul_cor

```

::: {style="text-align: center;font-weight: bold; font-size: 26px; font-family: Bradley Hand ITC;"}
Mapa de Correla√ß√£o das M√∫sicas dos √Ålbuns de Est√∫dio
:::

```{r}

set.seed(123)

raul_cor |>
  filter(correlation > 0.13) |>
  graph_from_data_frame() |>
  ggraph(layout = "fr") +
  geom_edge_link( show.legend = FALSE, aes(edge_alpha = correlation)) +
  geom_node_point(color = "olivedrab3", size = 2.5) +
  geom_node_text(aes(label = name), repel = TRUE, size = 2, color = "black") +
  theme_void()
  

```

## N√£o Pare na pista

```{=html}
<div style='text-align: left;'>
        <font size='2'>(<a href='https://open.spotify.com/intl-pt/track/34oupP2sVa8Yu55777neb3?si=1202e01dc4f64667' style='text-decoration: none;'>Gita, 1974</a>)</font>
      </div>
```
####### 

### Considera√ß√µes finais

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Por quem os sinos dobram</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Coragem, coragem, se o que voc√™ quer √© aquilo que pensa e faz / Coragem, coragem, eu sei que voc√™ pode mais"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/67un2wXjCB2SrcTYwaUHOi?si=f0fa7da98894444e' style='text-decoration: none;'>Por Quem os Sinos Dobram, 1979</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Percorremos um longo caminho at√© aqui.

Importamos as m√∫sicas e as letras, limpamos e manipulamos os dados. Vimos algumas caracter√≠scas da musicalidade como o qu√£o positiva √© o som de uma m√∫sica e o quanto ela √© dan√ßante. Contamos palavras, comparamos √°lbuns, analisamos sentimentos e a correla√ß√£o entre as m√∫sicas.

Tudo isso para mostrarmos que √© poss√≠vel utilizar ci√™ncia e an√°lise de dados em v√°rios √¢mbitos, at√© de uma forma despretenciosa e, para tentar entender melhor esse fen√¥meno que √© Raul Seixas. Mesmo ap√≥s tantos anos da sua morte, suas m√∫sicas ainda s√£o cantadas e seu nome lembrado com admira√ß√£o.

Um doido ou um g√™nio? E eu digo, porque n√£o ambos? O grande trunfo deste artista atemporal foi fazer da m√∫sica o ve√≠culo para falar de temas complexos como as rela√ß√µes humanas, moralidade, pol√≠tica, filosofia e religi√£o de uma maneira simples e sem se prender a um √∫nico estilo musical.
:::

### Trabalhos futuros

```{=html}

<div style='border: 4px solid #bdbdbd; border-radius: 15px; padding: 7px; background-color: #f0f0f0; display: inline-block; font-family: Calibri;'>
  <font color='#525252' size='4'>
    <div style='text-align: left;'>
      <b>Voc√™ ainda pode sonhar</b>
    </div>
  </font>
</div>

<div style='border: 4px solid #bdbdbd; border-radius: 14px; padding: 4px;'>
  <font color='#737373' size='3'>
    <div style='text-align: left;'>
      <i>"Voc√™ Ainda Pode Sonhar!"</i> 
      <div style='text-align: right;'>
        <font color='#525252' size='2'>(<a href='https://open.spotify.com/intl-pt/track/7jfGfsVorreQ3rLT9k5jdM?si=454865a1ecab4a66' style='text-decoration: none;'>Raulzito e Os Panteras, 1968</a>)</font>
      </div>
    </div>
  </font>
</div>
```
####### 

::: {style="text-align: justify;"}
Conhecendo melhor as APIs do *Spotify* e as bibliotecas do *R* ou qualquer outa linguagem *(Julia, Python, etc.)* que viabilize a an√°lise de dados, como sugest√£o de tema para poss√≠veis trabalhos futuros pode-se desenvolver uma m√°quina de aprendizado (*Machine Learning*) para ajudar f√£s do Raul Seixas a criarem *playlists* do artistia com m√∫sicas que se enquadrem nas prefer√™ncias identificadas nas caracter√≠sticas de suas contas mantidas na plataforma.

Outra ideia, √© se aprofundar mais na an√°lise de sentimentos dos textos e construir um gerador de m√∫sicas que nos permita criar nossas pr√≥prias m√∫sicas inspiradas no Raul Seixas.
:::
